{"version":3,"sources":["webpack:///src/app/pages/job-roles/job-roles.page.html","webpack:///src/app/pages/job-roles/job-roles-routing.module.ts","webpack:///src/app/pages/job-roles/job-roles.module.ts","webpack:///src/app/pages/job-roles/job-roles.page.scss","webpack:///src/app/pages/job-roles/job-roles.page.ts"],"names":["routes","path","component","JobRolesPageRoutingModule","imports","forChild","exports","JobRolesPageModule","declarations","config","sheet_name","value","noId","name","short_name","description","id","parent_id","organization_id","organization_name","JobRolesPage","apiAuth","apiCommon","socket","callbackProcess","res","Promise","resolve","error","presentAlert","message","JSON","stringify","emit","next","bind","convertColExcel2Number","val","base","i","j","result","length","Math","pow","indexOf","refreshNews","on","onChangeSelect","getDynamicUrl","serviceUrls","RESOURCE_SERVER","userReport","organizationId","organizations","organizationsTree","jobRolesTree","orgTree","jobRoles","Array","isArray","createTreeMenu","forEach","el","push","click_type","main_tree","subs","filter","x","rootSubs","elsub","index","findIndex","splice","unshift","console","log","ev","item","menu","icon","color","presentPopover","type","title","then","data","processDetails","err","event","status","$level","cmd","itemNew","undefined","table_name","wheres","title_name","addNewItem","stopItem","form","buttons","items","key","changed_date","display","picker","options","url","openModal","parent","callback","input_type","validators","required","min","max","hint","templateFile","responseType","blobData","fr","FileReader","readAsArrayBuffer","onloadend","bufferData","wb","xlsx","load","workbook","eachSheet","sheet","state","worksheet","getWorksheet","row","getRow","getCell","getColumn","width","alignment","wrapText","idx","views","y","height","firstSheet","activeTab","visibility","writeBuffer","blob","Blob","Date","now","arFile","target","files","results","eachRow","rowIndex","cols","Object","defineProperty","getValueFormula","values","returnFinish","count_success","count_fail","checkId","arr","jsonPost","postDynamicJson","obj","richText","map","o","join","selector","template"],"mappings":"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","file":"pages-job-roles-job-roles-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n      <ion-back-button></ion-back-button>\\r\\n      <ion-button>\\r\\n        <input class=\\\"file-over\\\" type=\\\"file\\\" (change)=\\\"onClickUpload($event)\\\"\\r\\n          accept=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\\\" />\\r\\n        <ion-icon name=\\\"cloud-upload\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-title>CÂY CHỨC DANH</ion-title>\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-button (click)=\\\"onClickDownload()\\\">\\r\\n        <ion-icon name=\\\"cloud-download\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content class=\\\"ion-no-padding\\\">\\r\\n  <ion-row>\\r\\n    <ion-col class=\\\"ion-text-center\\\" size=\\\"12\\\" class=\\\"card-prospect\\\" *ngFor=\\\"let item of organizationsTree\\\"\\r\\n      [style.background]=\\\"'#fafafaf6'\\\">\\r\\n\\r\\n      <ion-row (click)=\\\"onClickSpec($event, item)\\\">\\r\\n        <ion-col size=\\\"10\\\" class=\\\"prospect-header\\\" [style.color]=\\\"'darkblue'\\\">\\r\\n          <ion-icon item-start *ngIf=\\\"item.click_type\\\" style=\\\"font-size: 1em\\\" [style.color]=\\\"'lightblue'\\\"\\r\\n            name=\\\"md-cloud-upload\\\"></ion-icon>{{item.name}}\\r\\n        </ion-col>\\r\\n        <ion-col size=\\\"2\\\" class=\\\"prospect-header\\\" [style.color]=\\\"'darkblue'\\\">\\r\\n          {{item.id}}\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n\\r\\n      <tree-list [treeData]=\\\"item.subs\\\" (onClickKpi)=\\\"onClickTreeItem($event)\\\"></tree-list>\\r\\n\\r\\n    </ion-col>\\r\\n\\r\\n  </ion-row>\\r\\n</ion-content>\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { JobRolesPage } from './job-roles.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: JobRolesPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class JobRolesPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\n\r\nimport { JobRolesPageRoutingModule } from './job-roles-routing.module';\r\n\r\nimport { JobRolesPage } from './job-roles.page';\r\nimport { SharedModule } from 'src/app/shared.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    SharedModule,\r\n    JobRolesPageRoutingModule\r\n  ],\r\n  declarations: [JobRolesPage]\r\n})\r\nexport class JobRolesPageModule {}\r\n","export default \".card-title-header {\\n  font-size: 1.5em;\\n  width: 90%;\\n  font-weight: bold;\\n  color: darkblue;\\n  text-transform: uppercase;\\n  opacity: 0.7;\\n}\\n\\n.card-prospect {\\n  border-radius: 0.8em;\\n  border: solid 0.15em #FFFFFF;\\n  width: 100%;\\n}\\n\\n.card-prospect .prospect-header {\\n  font-size: 1.2em;\\n  width: 100%;\\n  font-weight: bold;\\n  text-transform: uppercase;\\n  opacity: 0.9;\\n}\\n\\n.table-row .table-header {\\n  background: #99b7f0e0 !important;\\n  color: #0a0909fb !important;\\n  font-weight: bold;\\n}\\n\\n.table-row ion-col {\\n  border: solid 0.1em #FFFFFF;\\n  font-size: 1.3em;\\n}\\n\\n.table-row ion-row:nth-of-type(odd) {\\n  background: #fafafaf6;\\n  color: #202020;\\n  opacity: 0.9;\\n}\\n\\n.table-row ion-row:nth-of-type(even) {\\n  background: #e6f5f8;\\n  color: #202020;\\n  opacity: 0.7;\\n}\\n\\n.file-over {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 2;\\n  width: 100%;\\n  height: 100%;\\n  opacity: 1;\\n  cursor: pointer;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvam9iLXJvbGVzL0U6XFxNWURBVEFcXExBUFRSSU5IXFxOT0RFNFxcbm9kZTQtcWxuc1xcY2xpZW50L3NyY1xcYXBwXFxwYWdlc1xcam9iLXJvbGVzXFxqb2Itcm9sZXMucGFnZS5zY3NzIiwic3JjL2FwcC9wYWdlcy9qb2Itcm9sZXMvam9iLXJvbGVzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQTtFQUNJLGdCQUFBO0VBQ0EsVUFBQTtFQUNBLGlCQUFBO0VBQ0EsZUFBQTtFQUNBLHlCQUFBO0VBQ0EsWUFBQTtBQ0FKOztBRElBO0VBQ0ksb0JBQUE7RUFDQSw0QkFBQTtFQUNBLFdBQUE7QUNESjs7QURLQTtFQUNJLGdCQUFBO0VBQ0EsV0FBQTtFQUNBLGlCQUFBO0VBQ0EseUJBQUE7RUFDQSxZQUFBO0FDRko7O0FETUE7RUFDSSxnQ0FBQTtFQUNBLDJCQUFBO0VBQ0EsaUJBQUE7QUNISjs7QURNQTtFQUNJLDJCQUFBO0VBQ0EsZ0JBQUE7QUNISjs7QURNQTtFQUNJLHFCQUFBO0VBQ0EsY0FBQTtFQUNBLFlBQUE7QUNISjs7QURNQTtFQUNJLG1CQUFBO0VBQ0EsY0FBQTtFQUNBLFlBQUE7QUNISjs7QURNQTtFQUNJLGtCQUFBO0VBQ0EsTUFBQTtFQUNBLE9BQUE7RUFDQSxVQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxVQUFBO0VBQ0EsZUFBQTtBQ0hKIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvam9iLXJvbGVzL2pvYi1yb2xlcy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIvL3RoaeG6v3QgbOG6rXAgY2jhu68gY2hvIHRpw6p1IMSR4buBIGPDtG5nIHR5XHJcbi5jYXJkLXRpdGxlLWhlYWRlciB7XHJcbiAgICBmb250LXNpemU6IDEuNWVtO1xyXG4gICAgd2lkdGg6IDkwJTtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgY29sb3I6IGRhcmtibHVlO1xyXG4gICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcclxuICAgIG9wYWNpdHk6IDAuNztcclxufVxyXG5cclxuLy9UaGnhur90IGzhuq1wIGtodW5nIG7hu4FuIHbDoCBj4buhIGNo4buvIGNobyBjYXJkIHZp4buFbiBj4bqjbmhcclxuLmNhcmQtcHJvc3BlY3R7XHJcbiAgICBib3JkZXItcmFkaXVzOiAwLjhlbTtcclxuICAgIGJvcmRlcjogc29saWQgMC4xNWVtICNGRkZGRkY7XHJcbiAgICB3aWR0aDoxMDAlO1xyXG4gICAgLy9vcGFjaXR5OiAwLjg7XHJcbn1cclxuXHJcbi5jYXJkLXByb3NwZWN0IC5wcm9zcGVjdC1oZWFkZXIge1xyXG4gICAgZm9udC1zaXplOiAxLjJlbTtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xyXG4gICAgb3BhY2l0eTogMC45O1xyXG59XHJcblxyXG4vL1RoaeG6v3QgbOG6rXAgZMOybmcgY2jhurVuIGzhursgY2hvIGLhuqNuZ1xyXG4udGFibGUtcm93IC50YWJsZS1oZWFkZXIgeyAvL3ThuqV0IGPhuqMgY8OhYyBj4buZdCBzYXUgY2xhc3MgbsOgeVxyXG4gICAgYmFja2dyb3VuZDogIzk5YjdmMGUwICFpbXBvcnRhbnQ7XHJcbiAgICBjb2xvcjojMGEwOTA5ZmIgIWltcG9ydGFudDtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG59XHJcblxyXG4udGFibGUtcm93IGlvbi1jb2wgeyAvL3ThuqV0IGPhuqMgY8OhYyBj4buZdCBzYXUgY2xhc3MgbsOgeVxyXG4gICAgYm9yZGVyOiBzb2xpZCAwLjFlbSAjRkZGRkZGO1xyXG4gICAgZm9udC1zaXplOiAxLjNlbTtcclxufVxyXG5cclxuLnRhYmxlLXJvdyBpb24tcm93Om50aC1vZi10eXBlKG9kZCkgeyAvL2TDsm5nIGzhurtcclxuICAgIGJhY2tncm91bmQ6ICNmYWZhZmFmNjtcclxuICAgIGNvbG9yOiMyMDIwMjA7XHJcbiAgICBvcGFjaXR5OiAwLjk7XHJcbn1cclxuXHJcbi50YWJsZS1yb3cgaW9uLXJvdzpudGgtb2YtdHlwZShldmVuKSB7IC8vZMOybmcgY2jhurVuXHJcbiAgICBiYWNrZ3JvdW5kOiAjZTZmNWY4O1xyXG4gICAgY29sb3I6IzIwMjAyMDtcclxuICAgIG9wYWNpdHk6IDAuNztcclxufVxyXG5cclxuLmZpbGUtb3ZlciB7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0b3A6IDA7XHJcbiAgICBsZWZ0OiAwO1xyXG4gICAgei1pbmRleDogMjtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgb3BhY2l0eTogMTtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxufSIsIi5jYXJkLXRpdGxlLWhlYWRlciB7XG4gIGZvbnQtc2l6ZTogMS41ZW07XG4gIHdpZHRoOiA5MCU7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICBjb2xvcjogZGFya2JsdWU7XG4gIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gIG9wYWNpdHk6IDAuNztcbn1cblxuLmNhcmQtcHJvc3BlY3Qge1xuICBib3JkZXItcmFkaXVzOiAwLjhlbTtcbiAgYm9yZGVyOiBzb2xpZCAwLjE1ZW0gI0ZGRkZGRjtcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi5jYXJkLXByb3NwZWN0IC5wcm9zcGVjdC1oZWFkZXIge1xuICBmb250LXNpemU6IDEuMmVtO1xuICB3aWR0aDogMTAwJTtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gIG9wYWNpdHk6IDAuOTtcbn1cblxuLnRhYmxlLXJvdyAudGFibGUtaGVhZGVyIHtcbiAgYmFja2dyb3VuZDogIzk5YjdmMGUwICFpbXBvcnRhbnQ7XG4gIGNvbG9yOiAjMGEwOTA5ZmIgIWltcG9ydGFudDtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG59XG5cbi50YWJsZS1yb3cgaW9uLWNvbCB7XG4gIGJvcmRlcjogc29saWQgMC4xZW0gI0ZGRkZGRjtcbiAgZm9udC1zaXplOiAxLjNlbTtcbn1cblxuLnRhYmxlLXJvdyBpb24tcm93Om50aC1vZi10eXBlKG9kZCkge1xuICBiYWNrZ3JvdW5kOiAjZmFmYWZhZjY7XG4gIGNvbG9yOiAjMjAyMDIwO1xuICBvcGFjaXR5OiAwLjk7XG59XG5cbi50YWJsZS1yb3cgaW9uLXJvdzpudGgtb2YtdHlwZShldmVuKSB7XG4gIGJhY2tncm91bmQ6ICNlNmY1Zjg7XG4gIGNvbG9yOiAjMjAyMDIwO1xuICBvcGFjaXR5OiAwLjc7XG59XG5cbi5maWxlLW92ZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgei1pbmRleDogMjtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgb3BhY2l0eTogMTtcbiAgY3Vyc29yOiBwb2ludGVyO1xufSJdfQ== */\";","import { Component, OnInit } from '@angular/core';\r\nimport { AuthService, CommonsService, PopoverCardComponent, DynamicFormMobilePage } from 'ngxi4-dynamic-service';\r\n\r\nimport * as Excel from \"exceljs\";\r\nimport * as fs from 'file-saver';\r\nimport { Socket } from 'ngx-socket-io';\r\n\r\nlet config = {\r\n  sheet_name: { value: 'job_roles' }\r\n  , noId: { value: \"A\" }\r\n  , name: { value: \"B\" }\r\n  , short_name: { value: \"C\" }\r\n  , description: { value: \"D\" }\r\n  , id: { value: \"E\" }\r\n  , parent_id: { value: \"F\" }\r\n  , organization_id: { value: \"G\" }\r\n  , organization_name: { value: \"H\" }\r\n}\r\n\r\n@Component({\r\n  selector: 'app-job-roles',\r\n  templateUrl: './job-roles.page.html',\r\n  styleUrls: ['./job-roles.page.scss'],\r\n})\r\nexport class JobRolesPage implements OnInit {\r\n\r\n  organizationId: any; //id tổ chức của user\r\n\r\n  userReport: any;\r\n\r\n  organizations: any; //danh sách tổ chức lấy từ csdl\r\n  organizationsTree: any; //cây tổ chức hiển thị\r\n\r\n  jobRoles: any; //danh sách chức danh lấy từ csdl\r\n  jobRolesTree: any; // cây chức danh\r\n\r\n  orgTree: any;// cây tổ chức theo organization_id của user\r\n\r\n  constructor(\r\n    private apiAuth: AuthService\r\n    , private apiCommon: CommonsService\r\n    , private socket: Socket\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.refreshNews();\r\n    this.socket.on(\"server-job-role-done\", () => {\r\n      this.onChangeSelect();\r\n    });\r\n  }\r\n\r\n  async refreshNews() {\r\n\r\n    try {\r\n      this.userReport = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-user-report\");\r\n      // console.log(this.userReport);\r\n\r\n      this.organizationId = this.userReport && this.userReport.organization_id ? this.userReport.organization_id : 0;\r\n\r\n      this.organizations = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-organizations\");\r\n      // console.log(this.organizations);\r\n\r\n    } catch (e) { }\r\n\r\n    this.onChangeSelect();\r\n  }\r\n\r\n  /**\r\n   * Khi có thay đổi thêm mới/cập nhật/xóa\r\n   */\r\n  async onChangeSelect() {\r\n\r\n    this.organizationsTree = [];\r\n    this.jobRolesTree = [];\r\n    this.orgTree = [];\r\n\r\n    try {\r\n      // lấy danh sách chức danh trong csdl\r\n      this.jobRoles = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-job-roles\");\r\n      // console.log(this.jobRoles);\r\n\r\n      // Chuyển thành cây chức danh\r\n      if (Array.isArray(this.jobRoles)) {\r\n        this.jobRolesTree = this.apiCommon.createTreeMenu(this.jobRoles, 'id', 'parent_id');\r\n        // console.log(this.jobRolesTree);\r\n      }\r\n\r\n      // lọc lấy những tổ chức theo id tổ chức của user\r\n      this.organizations.forEach(el => {\r\n        if (el.id === this.organizationId) {\r\n          this.orgTree.push(el)\r\n        }\r\n        if (el.parent_id === this.organizationId) {\r\n          this.orgTree.push(el)\r\n        }\r\n      })\r\n      // console.log(this.orgTree);\r\n\r\n      // thêm thuộc tính click_type và main_tree cho cây chính\r\n      // ghép cây chức danh vào cây chính\r\n      this.orgTree.forEach(el => {\r\n        el.click_type = 1; //cây chính cho click luôn\r\n        el.main_tree = 1; //là cây chính\r\n\r\n        // Nếu id khác id tổ chức của user thì mới ghép vào (tức là ds các chức danh của tổ chức, không phải là giám đốc)\r\n        if (this.jobRolesTree && el.id !== this.organizationId) {\r\n          // ghép cây chức danh vào làm nhánh của cây tổ chức theo id tổ chức\r\n          el.subs = this.jobRolesTree.filter(x => x.organization_id === el.id);\r\n        }\r\n\r\n      });\r\n      // console.log(this.orgTree);\r\n\r\n      // chuyển cây tổ chức và chức danh thành cây chính để hiển thị\r\n      this.organizationsTree = this.apiCommon.createTreeMenu(this.orgTree, 'id', 'parent_id');\r\n\r\n      // console.log(this.organizationsTree);\r\n\r\n      // ghép chức danh giám đốc vào\r\n      this.organizationsTree.forEach(el => {\r\n        if (this.jobRolesTree && el.id + '' === '' + this.organizationId) {\r\n          let rootSubs = this.jobRolesTree.filter(x => x.organization_id === el.id);\r\n          if (!el.subs) el.subs = rootSubs;\r\n\r\n          rootSubs.forEach(elsub => {\r\n            let index = el.subs.findIndex(x => x.id === elsub.id && x.organization_id == elsub.organization_id);\r\n            if (index >= 0) {\r\n              el.subs.splice(index, 1, elsub);\r\n            } else {\r\n              el.subs.unshift(elsub);\r\n            }\r\n          })\r\n        }\r\n      })\r\n\r\n    } catch (e) {\r\n      console.log('Error:', e)\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Click vào nội dung cấp Công ty/Trung tâm\r\n   * @param ev \r\n   * @param card \r\n   */\r\n  onClickSpec(ev, item) {\r\n    //console.log(item);\r\n    let menu = [\r\n      {\r\n        name: \"Thêm chức danh GĐ\",\r\n        value: \"add-child\",\r\n        icon: {\r\n          name: \"md-add\",\r\n          color: \"secondary\",\r\n        }\r\n      }\r\n    ];\r\n\r\n    //Thực hiện hiển thị menu\r\n    this.apiCommon.presentPopover(\r\n      ev, PopoverCardComponent\r\n      , {\r\n        type: 'single-choice',\r\n        title: \"Chọn chức năng\",\r\n        color: \"primary\",\r\n        menu: menu\r\n      })\r\n      .then(data => {\r\n        // console.log(data);\r\n        this.processDetails(data, item)\r\n      })\r\n      .catch(err => {\r\n        console.log('err: ', err);\r\n      });\r\n\r\n  }\r\n\r\n  /**\r\n   * Click vào đơn vị cấp con\r\n   * @param event \r\n   */\r\n  onClickTreeItem(event) {\r\n\r\n    //Khai báo menu popup\r\n    let menu;\r\n\r\n    //cây chức danh thuần\r\n    // console.log(event.item);\r\n    if (!event.item.main_tree) {\r\n      menu = [\r\n        {\r\n          icon: {\r\n            name: \"md-create\",\r\n            color: \"primary\",\r\n          },\r\n          name: \"Chỉnh sửa chức danh\",\r\n          value: \"edit-owner\"\r\n        }\r\n        ,\r\n        {\r\n          icon: {\r\n            name: \"trash\",\r\n            color: \"danger\",\r\n          },\r\n          name: event.item.status === 1 ? \"Khóa bỏ chức danh\" : \"Kích hoạt chức danh\",\r\n          value: \"stop-owner\"\r\n        }\r\n      ];\r\n\r\n      //Nếu là chức danh quản lý thì mới có menu thêm chức danh con\r\n      if (event.item.$level == 1) {\r\n        menu.unshift({\r\n          icon: {\r\n            name: \"md-add\",\r\n            color: \"secondary\",\r\n          },\r\n          name: \"Thêm chức danh con\",\r\n          value: \"add-child\"\r\n        })\r\n      }\r\n    } else {\r\n      menu = [\r\n        {\r\n          icon: {\r\n            name: \"md-add\",\r\n            color: \"secondary\",\r\n          },\r\n          name: \"Thêm chức danh TP\",\r\n          value: \"add-child\"\r\n        }\r\n      ];\r\n    }\r\n\r\n    //Thực hiện hiển thị menu\r\n    this.apiCommon.presentPopover(\r\n      event.event, PopoverCardComponent\r\n      , {\r\n        type: 'single-choice',\r\n        title: \"Chọn chức năng\",\r\n        color: \"primary\",\r\n        menu: menu\r\n      })\r\n      .then(data => {\r\n        // console.log(data);\r\n        this.processDetails(data, event.item)\r\n      })\r\n      .catch(err => {\r\n        console.log('err: ', err);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Xử lý từng lệnh \r\n   * @param cmd \r\n   * @param item \r\n   */\r\n  processDetails(cmd, item) {\r\n\r\n    //thêm tham số\r\n    if (cmd.value === 'add-child') {\r\n      let itemNew = {\r\n        id: -1, //Giả id để thêm vào\r\n        parent_id: item.main_tree === 1 ? undefined : item.id, //kế thừa cấp cha của nó\r\n        organization_id: item.organization_id ? item.organization_id : item.id,//mã tổ chức của nó hoặc cấp cha\r\n        table_name: 'job_roles', //tên bảng cần đưa vào\r\n        wheres: [], //Mệnh đề wheres để update\r\n        title_name: item.name //tên của cấp cha\r\n      }\r\n\r\n      this.addNewItem(itemNew, 'add');\r\n    }\r\n\r\n    //sửa tham số\r\n    if (cmd.value === 'edit-owner') {\r\n\r\n      item.table_name = 'job_roles'; //tên bảng cần đưa vào\r\n      item.wheres = ['id'];         //Mệnh đề wheres để update\r\n      item.title_name = item.name;\r\n\r\n      this.addNewItem(item, 'edit');\r\n    }\r\n\r\n    //tạm dừng tham số\r\n    if (cmd.value === 'stop-owner') {\r\n\r\n      item.table_name = 'job_roles'; //tên bảng cần đưa vào\r\n      item.wheres = ['id'];         //Mệnh đề wheres để update\r\n\r\n      this.stopItem(item);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Dừng đối tượng này\r\n   * @param item \r\n   */\r\n  stopItem(item) {\r\n    let form = {\r\n      title: \"Thay đổi trạng thái\"\r\n      , buttons: [\r\n        { color: \"danger\", icon: \"close\", next: \"CLOSE\" }\r\n      ]\r\n      , items: [\r\n        { type: \"title\", name: item.name }\r\n        , { type: \"hidden\", key: \"id\", value: item.id }\r\n        , { type: \"hidden\", key: \"table_name\", value: item.table_name }\r\n        , { type: \"hidden\", key: \"wheres\", value: item.wheres }\r\n        , { type: \"datetime\", key: \"changed_date\", value: item.changed_date, name: \"Chọn ngày thay đổi trạng thái\", display: \"DD/MM/YYYY\", picker: \"DD/MM/YYYY\" }\r\n        , { type: \"toggle\", key: \"status\", name: item.status ? \"Tạm ngưng?\" : \"Kích hoạt?\", value: item.status, color: \"secondary\", icon: \"hand\" }\r\n        , {\r\n          type: \"button\"\r\n          , options: [\r\n            {\r\n              name: 'Cập nhập', next: \"CALLBACK\", url: this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + \"/post-parameters\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n\r\n    this.apiCommon.openModal(DynamicFormMobilePage, {\r\n      parent: this,\r\n      form: form,\r\n      callback: this.callbackProcess\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Thêm hoặc sửa chức danh\r\n   * @param item \r\n   */\r\n  addNewItem(item, type) {\r\n\r\n    let form = {\r\n      title: (type === 'add' ? 'THÊM' : 'SỬA') + \" DANH MỤC\"\r\n      , buttons: [\r\n        { color: \"danger\", icon: \"close\", next: \"CLOSE\" }\r\n      ]\r\n      , items: [\r\n        { type: \"title\", name: item.title_name }\r\n        , { type: \"hidden\", key: \"id\", value: item.id }\r\n        , { type: \"hidden\", key: \"parent_id\", value: item.parent_id }\r\n        , { type: \"hidden\", key: \"organization_id\", value: item.organization_id }\r\n        , { type: \"hidden\", key: \"table_name\", value: item.table_name }\r\n        , { type: \"hidden\", key: \"wheres\", value: item.wheres }\r\n\r\n        , { type: \"text\", key: \"short_name\", value: item.short_name, name: \"Nhóm chức danh\", input_type: \"text\", icon: \"ios-people\", validators: [{ required: true, min: 2, max: 20 }], hint: \"Mã nhóm viết tắt vd: TT-VT để nhóm cùng loại khác đơn vị\" }\r\n        , { type: \"text\", key: \"name\", value: item.name, name: \"Tên chức danh\", input_type: \"text\", icon: \"calendar\", validators: [{ required: true, min: 5, max: 100 }], hint: \"Độ dài tên cho phép từ 5 đến 100 ký tự\" }\r\n        , { type: \"text_area\", key: \"description\", value: item.description, name: \"Mô tả công việc của chức danh này\", input_type: \"text\", icon: \"md-alert\", hint: \"Nhập mô tả chức danh này để ghi nhớ, công việc làm gì\" }\r\n        , {\r\n          type: \"button\"\r\n          , options: [\r\n            { name: \"Reset\", next: \"RESET\" }\r\n            , {\r\n              name: type === 'add' ? 'Tạo mới' : 'Chỉnh sửa', next: \"CALLBACK\"\r\n              , url: this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + \"/post-parameters\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n\r\n    this.apiCommon.openModal(DynamicFormMobilePage, {\r\n      parent: this,\r\n      form: form,\r\n      callback: this.callbackProcess\r\n    })\r\n\r\n  }\r\n\r\n  /**\r\n   * Hàm xử lý kết quả post sửa thêm xóa\r\n   */\r\n  callbackProcess = function (res) {\r\n\r\n    //console.log(res);\r\n\r\n    return new Promise(resolve => {\r\n\r\n      if (res.error) {\r\n        this.apiCommon.presentAlert('Lỗi:<br>' + (res.error && res.error.message ? res.error.message : \"Error Unknow: \" + JSON.stringify(res.error)));\r\n      } else {\r\n        //Báo cho socket biết là thực hiện xong\r\n        this.socket.emit('client-job-role-done');\r\n      }\r\n      resolve({ next: \"CLOSE\" })\r\n    })\r\n  }.bind(this)\r\n\r\n  async onClickDownload() {\r\n    let templateFile = this.apiAuth.serviceUrls.RESOURCE_SERVER + '/get-templates/sample-danhmuc-tochuc.xlsx'\r\n    let blobData = await this.apiAuth.getDynamicUrl(templateFile, '', { responseType: 'blob' });\r\n    let fr = new FileReader();\r\n    fr.readAsArrayBuffer(blobData);\r\n    fr.onloadend = async () => {\r\n      let bufferData: any = fr.result;\r\n      let wb = new Excel.Workbook();\r\n      let workbook = await wb.xlsx.load(bufferData);\r\n      //ẩn các sheet không mong muốn\r\n      workbook.eachSheet(sheet => {\r\n        if (sheet.name !== config.sheet_name.value) sheet.state = 'hidden';\r\n      })\r\n      let worksheet = workbook.getWorksheet(config.sheet_name.value);\r\n\r\n      let row = worksheet.getRow(2);\r\n      row.getCell(\"A\").value = this.organizationsTree[0].name;\r\n      row.getCell(\"E\").value = this.organizationsTree[0].id;\r\n\r\n      // xác định bề rộng cho các cột\r\n      worksheet.getColumn(1).width = 5\r\n      worksheet.getColumn(2).width = 30\r\n      worksheet.getColumn(3).width = 18\r\n      worksheet.getColumn(4).width = 30\r\n      worksheet.getColumn(8).width = 20\r\n\r\n      // tự động xuống hàng nếu text quá dài\r\n      worksheet.getColumn(2).alignment = { wrapText: true };\r\n      worksheet.getColumn(3).alignment = { wrapText: true };\r\n      worksheet.getColumn(4).alignment = { wrapText: true };\r\n      worksheet.getColumn(8).alignment = { wrapText: true };\r\n\r\n      let idx = 4;\r\n      // Lặp mảng để ghi dữ liệu vào excel\r\n      this.jobRoles.forEach(el => {\r\n        row = worksheet.getRow(idx);\r\n        row.getCell(config.noId.value).value = idx - 3;\r\n        row.getCell(config.name.value).value = el.name;\r\n        row.getCell(config.short_name.value).value = el.short_name;\r\n        row.getCell(config.description.value).value = el.description;\r\n        row.getCell(config.id.value).value = el.id;\r\n        row.getCell(config.parent_id.value).value = el.parent_id;\r\n        row.getCell(config.organization_id.value).value = el.organization_id;\r\n        row.getCell(config.organization_name.value).value = el.organization_name;\r\n        idx++;\r\n      });\r\n\r\n      workbook.views = [\r\n        {\r\n          x: 0, y: 0, width: 10000, height: 20000,\r\n          firstSheet: 1, activeTab: 1, visibility: 'visible'\r\n        }\r\n      ];\r\n\r\n      //Ghi file excel\r\n      workbook.xlsx.writeBuffer().then((data) => {\r\n        let blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\r\n        fs.saveAs(blob, `excel-job_roles-${Date.now()}.xlsx`);\r\n      })\r\n    }\r\n  }\r\n\r\n  onClickUpload(ev) {\r\n    let arFile = ev.target.files;\r\n    // console.log(arFile);\r\n    let fr = new FileReader();\r\n    fr.readAsArrayBuffer(arFile[0]);\r\n    fr.onloadend = async () => {\r\n      let bufferData: any = fr.result;\r\n      let wb = new Excel.Workbook();\r\n      try {\r\n        let workbook = await wb.xlsx.load(bufferData)\r\n        let worksheet = workbook.getWorksheet(config.sheet_name.value);\r\n        let results = []\r\n        worksheet.eachRow((row, rowIndex) => {\r\n          if (rowIndex > 3) {\r\n            let cols = {}\r\n            for (let key in config) {\r\n              let item = config[key];\r\n              if (key != \"sheet_name\") {\r\n                Object.defineProperty(cols\r\n                  , key\r\n                  , { value: this.getValueFormula(row.values[this.convertColExcel2Number(item.value)]) })\r\n              }\r\n            }\r\n            results.push(cols);\r\n          }\r\n        })\r\n        // console.log(results);\r\n        let returnFinish = { count_success: 0, count_fail: 0 };\r\n        // hàm này để kiểm tra organization_id post lên có nằm trong danh sách organization_id của user không?\r\n        let checkId = (id, arr) => {\r\n          for (let el of arr) {\r\n            if (id === el.id) return true;\r\n          }\r\n          return false;\r\n        }\r\n        for (const el of results) {\r\n          if (checkId(el.organization_id, this.orgTree)) {\r\n            let jsonPost = {\r\n              name: el.name,\r\n              short_name: el.short_name,\r\n              description: el.description,\r\n              id: el.id,\r\n              parent_id: el.parent_id,\r\n              organization_id: el.organization_id\r\n            }\r\n            // console.log(jsonPost);\r\n            try {\r\n              await this.apiAuth.postDynamicJson(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + '/post-job-roles', jsonPost)\r\n              returnFinish.count_success++;\r\n            } catch (err) {\r\n              // console.log(err);\r\n              returnFinish.count_fail++;\r\n            }\r\n          }\r\n        }\r\n        console.log(returnFinish);\r\n        //Báo cho socket biết là thực hiện xong\r\n        this.socket.emit('client-job-role-done');\r\n\r\n      } catch (err) {\r\n        console.log('Lỗi đọc file excel nguồn!', err);\r\n      } finally {\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  convertColExcel2Number = (val: string): number => {\r\n    var base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', i, j, result = 0;\r\n    for (i = 0, j = val.length - 1; i < val.length; i += 1, j -= 1) {\r\n      result += Math.pow(base.length, j) * (base.indexOf(val[i]) + 1);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  getValueFormula(obj) {\r\n    if (obj === null || obj === undefined) return null\r\n    if (typeof obj === 'object') {\r\n      // xử lý chuyển đổi chỉ lấy text thôi\r\n      if (obj.richText) return obj.richText.map(o => o[\"text\"]).join(\"\")\r\n      // lấy giá trị bằng biểu thức function\r\n      return obj.result\r\n    }\r\n    return obj\r\n  }\r\n}"]}