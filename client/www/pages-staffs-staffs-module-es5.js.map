{"version":3,"sources":["webpack:///src/app/pages/staffs/staffs.page.html","webpack:///src/app/pages/staffs/staffs-routing.module.ts","webpack:///src/app/pages/staffs/staffs.module.ts","webpack:///src/app/pages/staffs/staffs.page.scss","webpack:///src/app/pages/staffs/staffs.page.ts"],"names":["routes","path","component","StaffsPageRoutingModule","imports","forChild","exports","StaffsPageModule","declarations","config","sheet_name","value","noId","name","organization_id","organization_name","job_id","job_name","id","job_list","job_list_name","StaffsPage","apiAuth","apiCommon","socket","callbackProcess","res","Promise","resolve","error","presentAlert","message","JSON","stringify","ajax","key","jobOptions","jobListOptions","Array","isArray","jobRoles","forEach","el","push","parseInt","property_name","new_data","elSelected","find","x","emit","next","bind","convertColExcel2Number","val","base","i","j","result","length","Math","pow","indexOf","refreshNews","on","onChangeSelect","getDynamicUrl","serviceUrls","RESOURCE_SERVER","organizations","userReport","organizationId","console","log","organizationsTree","orgTree","staffs","parent_id","click_type","main_tree","subs","filter","createTreeMenu","rootSubs","elsub","index","findIndex","splice","unshift","ev","item","menu","icon","color","presentPopover","type","title","then","data","processDetails","err","event","status","cmd","itemNew","table_name","wheres","title_name","addNewItem","stopItem","orgOptions","list_str","form","buttons","items","input_type","validators","required","min","max","hint","options","undefined","url","openModal","parent","callback","home_disable","changed_date","display","picker","templateFile","responseType","blobData","fr","FileReader","readAsArrayBuffer","onloadend","bufferData","wb","xlsx","load","workbook","eachSheet","sheet","state","worksheet","getWorksheet","row","getRow","getCell","getColumn","width","alignment","wrapText","idx","views","y","height","firstSheet","activeTab","visibility","writeBuffer","blob","Blob","Date","now","arFile","target","files","results","eachRow","rowIndex","cols","Object","defineProperty","getValueFormula","values","returnFinish","count_success","count_fail","checkId","arr","jsonPost","postDynamicJson","obj","richText","map","o","join","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKf,QAAMA,MAAM,GAAW,CACrB;AACEC,UAAI,EAAE,EADR;AAEEC,eAAS,EAAE;AAFb,KADqB,CAAvB;;AAWA,QAAaC,uBAAuB;AAAA;AAAA,KAApC;;AAAaA,2BAAuB,6DAJnC,+DAAS;AACRC,aAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,aAAO,EAAE,CAAC,4DAAD;AAFD,KAAT,CAImC,GAAvBH,uBAAuB,CAAvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFb,QAAaI,gBAAgB;AAAA;AAAA,KAA7B;;AAAaA,oBAAgB,6DAP5B,+DAAS;AACRH,aAAO,EAAE,CACP,kEADO,EAEP,8EAFO,CADD;AAKRI,kBAAY,EAAE,CAAC,uDAAD;AALN,KAAT,CAO4B,GAAhBD,gBAAgB,CAAhB;;;;;;;;;;;;;;;;ACdb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACOf,QAAIE,MAAM,GAAG;AACXC,gBAAU,EAAE;AAAEC,aAAK,EAAE;AAAT,OADD;AAETC,UAAI,EAAE;AAAED,aAAK,EAAE;AAAT,OAFG;AAGTE,UAAI,EAAE;AAAEF,aAAK,EAAE;AAAT,OAHG;AAITG,qBAAe,EAAE;AAAEH,aAAK,EAAE;AAAT,OAJR;AAKTI,uBAAiB,EAAE;AAAEJ,aAAK,EAAE;AAAT,OALV;AAMTK,YAAM,EAAE;AAAEL,aAAK,EAAE;AAAT,OANC;AAOTM,cAAQ,EAAE;AAAEN,aAAK,EAAE;AAAT,OAPD;AAQTO,QAAE,EAAE;AAAEP,aAAK,EAAE;AAAT,OARK;AASTQ,cAAQ,EAAE;AAAER,aAAK,EAAE;AAAT,OATD;AAUTS,mBAAa,EAAE;AAAET,aAAK,EAAE;AAAT;AAVN,KAAb;;AAkBA,QAAaU,UAAU;AAcrB,0BACUC,OADV,EAEYC,SAFZ,EAGYC,MAHZ,EAG0B;AAAA;;AAFhB,aAAAF,OAAA,GAAAA,OAAA;AACE,aAAAC,SAAA,GAAAA,SAAA;AACA,aAAAC,MAAA,GAAAA,MAAA;AAoYZ;;;;AAGA,aAAAC,eAAA,GAAkB,UAAUC,GAAV,EAAe;AAAA;;AAE/B;AAEA,iBAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAE5B,gBAAIF,GAAG,CAACG,KAAR,EAAe;AACb,mBAAI,CAACN,SAAL,CAAeO,YAAf,CAA4B,cAAcJ,GAAG,CAACG,KAAJ,IAAaH,GAAG,CAACG,KAAJ,CAAUE,OAAvB,GAAiCL,GAAG,CAACG,KAAJ,CAAUE,OAA3C,GAAqD,mBAAmBC,IAAI,CAACC,SAAL,CAAeP,GAAG,CAACG,KAAnB,CAAtF,CAA5B;AACD,aAFD,MAEO,IAAIH,GAAG,CAACQ,IAAR,EAAc;AACnB;AACA;AACA,kBAAIR,GAAG,CAACQ,IAAJ,CAASC,GAAT,KAAiB,iBAAjB,IAAsCT,GAAG,CAACQ,IAAJ,CAASvB,KAAnD,EAA0D;AAExD;AACA,oBAAIyB,UAAU,GAAG,EAAjB,CAHwD,CAKxD;;AACA,oBAAIC,cAAc,GAAG,EAArB,CANwD,CAQxD;;AACA,oBAAIC,KAAK,CAACC,OAAN,CAAc,KAAI,CAACC,QAAnB,CAAJ,EAAkC;AAChC,uBAAI,CAACA,QAAL,CAAcC,OAAd,CAAsB,UAAAC,EAAE,EAAI;AAC1B;AACA,wBAAIA,EAAE,CAAC5B,eAAH,IAAsBY,GAAG,CAACQ,IAAJ,CAASvB,KAAnC,EAA0C;AAAC;AAEzC;AACAyB,gCAAU,CAACO,IAAX,CAAgB;AAAE9B,4BAAI,EAAE6B,EAAE,CAAC7B,IAAX;AAAiBF,6BAAK,EAAEiC,QAAQ,CAACF,EAAE,CAACxB,EAAJ;AAAhC,uBAAhB,EAHwC,CAKxC;;AACAmB,oCAAc,CAACM,IAAf,CAAoB;AAAE9B,4BAAI,EAAE6B,EAAE,CAAC7B,IAAX;AAAiBF,6BAAK,EAAEiC,QAAQ,CAACF,EAAE,CAACxB,EAAJ;AAAhC,uBAApB;AACD;AAEF,mBAXD;AAYD,iBAtBuD,CAwBxD;;;AACAU,uBAAO,CAAC,CACN;AACEO,qBAAG,EAAE,QADP,CACgB;AADhB;AAEIU,+BAAa,EAAE,SAFnB,CAE+B;AAF/B;AAGIC,0BAAQ,EAAEV,UAHd,CAGyB;;AAHzB,iBADM,EAON;AACED,qBAAG,EAAE,UADP,CACkB;AADlB;AAEIU,+BAAa,EAAE,SAFnB,CAE+B;AAF/B;AAGIC,0BAAQ,EAAET,cAHd,CAG6B;;AAH7B,iBAPM,CAAD,CAAP;AAcD,eAvCD,MAuCO,IAAIX,GAAG,CAACQ,IAAJ,CAASC,GAAT,KAAiB,QAAjB,IAA6BT,GAAG,CAACQ,IAAJ,CAASvB,KAA1C,EAAiD;AACtD;AACA;AACA,oBAAI0B,eAAc,GAAG,EAArB;;AAEA,oBAAIC,KAAK,CAACC,OAAN,CAAc,KAAI,CAACC,QAAnB,CAAJ,EAAkC;AAEhC;AACA,sBAAIO,UAAU,GAAG,KAAI,CAACP,QAAL,CAAcQ,IAAd,CAAmB,UAAAC,CAAC;AAAA,2BAAIA,CAAC,CAAC/B,EAAF,IAAQQ,GAAG,CAACQ,IAAJ,CAASvB,KAArB;AAAA,mBAApB,CAAjB;;AAEA,sBAAIoC,UAAJ,EAAgB;AACd,yBAAI,CAACP,QAAL,CAAcC,OAAd,CAAsB,UAAAC,EAAE,EAAI;AAC1B;AACA;AACA,0BAAIA,EAAE,CAAC5B,eAAH,KAAuBiC,UAAU,CAACjC,eAAlC,IAAqD4B,EAAE,CAACxB,EAAH,IAASQ,GAAG,CAACQ,IAAJ,CAASvB,KAA3E,EAAkF;AAChF0B,uCAAc,CAACM,IAAf,CAAoB;AAAE9B,8BAAI,EAAE6B,EAAE,CAAC7B,IAAX;AAAiBF,+BAAK,EAAEiC,QAAQ,CAACF,EAAE,CAACxB,EAAJ;AAAhC,yBAApB;AACD;AACF,qBAND;AAOD,mBAb+B,CAehC;AACA;;;AACAU,yBAAO,CACL;AACEO,uBAAG,EAAE,UADP,CACkB;AADlB;AAEIU,iCAAa,EAAE,SAFnB,CAE+B;AAF/B;AAGIC,4BAAQ,EAAET,eAHd,CAG6B;;AAH7B,mBADK,CAAP;AAQD;AAEF;;AAED,qBA5EmB,CA4EX;AAET,aA9EM,MA8EA;AACL;AACA,mBAAI,CAACb,MAAL,CAAY0B,IAAZ,CAAiB,mBAAjB;AACD;;AACDtB,mBAAO,CAAC;AAAEuB,kBAAI,EAAE;AAAR,aAAD,CAAP;AACD,WAvFM,CAAP;AAwFD,SA5FiB,CA4FhBC,IA5FgB,CA4FX,IA5FW,CAAlB;;AAkOA,aAAAC,sBAAA,GAAyB,UAACC,GAAD,EAAyB;AAChD,cAAIC,IAAI,GAAG,4BAAX;AAAA,cAAyCC,CAAzC;AAAA,cAA4CC,CAA5C;AAAA,cAA+CC,MAAM,GAAG,CAAxD;;AACA,eAAKF,CAAC,GAAG,CAAJ,EAAOC,CAAC,GAAGH,GAAG,CAACK,MAAJ,GAAa,CAA7B,EAAgCH,CAAC,GAAGF,GAAG,CAACK,MAAxC,EAAgDH,CAAC,IAAI,CAAL,EAAQC,CAAC,IAAI,CAA7D,EAAgE;AAC9DC,kBAAM,IAAIE,IAAI,CAACC,GAAL,CAASN,IAAI,CAACI,MAAd,EAAsBF,CAAtB,KAA4BF,IAAI,CAACO,OAAL,CAAaR,GAAG,CAACE,CAAD,CAAhB,IAAuB,CAAnD,CAAV;AACD;;AACD,iBAAOE,MAAP;AACD,SAND;AAxmBK;;AAlBgB;AAAA;AAAA,mCAoBV;AAAA;;AACT,eAAKK,WAAL;AACA,eAAKvC,MAAL,CAAYwC,EAAZ,CAAe,mBAAf,EAAoC,YAAM;AACxC,kBAAI,CAACC,cAAL;AACD,WAFD;AAGD;AAzBoB;AAAA;AAAA,sCA2BD;;;;;;;;AAIK,2BAAM,KAAK3C,OAAL,CAAa4C,aAAb,CAA2B,KAAK5C,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GAClD,oBADuB,CAAN;;;AAArB,yBAAKC,a;;AAOa,2BAAM,KAAK/C,OAAL,CAAa4C,aAAb,CAA2B,KAAK5C,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GAC/C,kBADoB,CAAN;;;AAAlB,yBAAKE,U;AAGL;AAEA;AACA,yBAAKC,cAAL,GAAsB,KAAKD,UAAL,IAAmB,KAAKA,UAAL,CAAgBxD,eAAnC,GAAqD,KAAKwD,UAAL,CAAgBxD,eAArE,GAAuF,CAA7G,C,CAEA;;;AACgB,2BAAM,KAAKQ,OAAL,CAAa4C,aAAb,CAA2B,KAAK5C,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GAC7C,gBADkB,CAAN;;;AAAhB,yBAAK5B,Q;;;;;;;AAMLgC,2BAAO,CAACC,GAAR,CAAY,KAAZ;;;AAGF,yBAAKR,cAAL;;;;;;;;;AACD;AAED;;;;AA3DqB;AAAA;AAAA,yCA8DE;;;;;;;;AAErB;AACA,yBAAKS,iBAAL,GAAyB,EAAzB;AACA,yBAAKC,OAAL,GAAe,EAAf;;;AAIgB,2BAAM,KAAKrD,OAAL,CAAa4C,aAAb,CAA2B,KAAK5C,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GAC3C,aADgB,CAAN;;;AAAd,yBAAKQ,M;AAEL,yBAAKA,MAAL,CAAYnC,OAAZ,CAAoB,UAAAC,EAAE,EAAI;AACxB,0BAAIA,EAAE,CAACtB,aAAP,EAAsB;AACpB,4BAAIP,IAAI,GAAG,EAAX;AACA6B,0BAAE,CAACtB,aAAH,CAAiBqB,OAAjB,CAAyB,UAAAC,EAAE,EAAI;AAC7B7B,8BAAI,CAAC8B,IAAL,CAAUD,EAAE,CAAC7B,IAAb;AACD,yBAFD;AAGA6B,0BAAE,CAACtB,aAAH,GAAmBP,IAAnB;AACD;AACF,qBARD,E,CASA;;AAEA,wBAAIyB,KAAK,CAACC,OAAN,CAAc,KAAKqC,MAAnB,CAAJ,EAAgC;AAE9B;AACA,2BAAKP,aAAL,CAAmB5B,OAAnB,CAA2B,UAAAC,EAAE,EAAI;AAC/B,4BAAIA,EAAE,CAACxB,EAAH,KAAU,MAAI,CAACqD,cAAnB,EAAmC;AACjC,gCAAI,CAACI,OAAL,CAAahC,IAAb,CAAkBD,EAAlB;AACD;;AACD,4BAAIA,EAAE,CAACmC,SAAH,KAAiB,MAAI,CAACN,cAA1B,EAA0C;AACxC,gCAAI,CAACI,OAAL,CAAahC,IAAb,CAAkBD,EAAlB;AACD;AACF,uBAPD;AASA,2BAAKiC,OAAL,CAAalC,OAAb,CAAqB,UAAAC,EAAE,EAAI;AACzBA,0BAAE,CAACoC,UAAH,GAAgB,CAAhB,CADyB,CACN;;AACnBpC,0BAAE,CAACqC,SAAH,GAAe,CAAf,CAFyB,CAEP;AAElB;AACA;;AACA,4BAAI,MAAI,CAACH,MAAL,IAAelC,EAAE,CAACxB,EAAH,KAAU,MAAI,CAACqD,cAAlC,EAAkD;AAChD;AACA7B,4BAAE,CAACsC,IAAH,GAAU,MAAI,CAACJ,MAAL,CAAYK,MAAZ,CAAmB,UAAAhC,CAAC;AAAA,mCAAIA,CAAC,CAACnC,eAAF,KAAsB4B,EAAE,CAACxB,EAA7B;AAAA,2BAApB,CAAV;AACD;AAEF,uBAXD,EAZ8B,CAwB9B;AAEA;;AACA,2BAAKwD,iBAAL,GAAyB,KAAKnD,SAAL,CAAe2D,cAAf,CAA8B,KAAKP,OAAnC,EAA4C,IAA5C,EAAkD,WAAlD,CAAzB,CA3B8B,CA4B9B;AAEA;;AACA,2BAAKD,iBAAL,CAAuBjC,OAAvB,CAA+B,UAAAC,EAAE,EAAI;AACnC;AACA,4BAAI,MAAI,CAACkC,MAAL,IAAelC,EAAE,CAACxB,EAAH,GAAQ,EAAR,KAAe,KAAK,MAAI,CAACqD,cAA5C,EAA4D;AAC1D,8BAAIY,QAAQ,GAAG,MAAI,CAACP,MAAL,CAAYK,MAAZ,CAAmB,UAAAhC,CAAC;AAAA,mCAAIA,CAAC,CAACnC,eAAF,KAAsB4B,EAAE,CAACxB,EAA7B;AAAA,2BAApB,CAAf,CAD0D,CAE1D;;;AACA,8BAAI,CAACwB,EAAE,CAACsC,IAAR,EAActC,EAAE,CAACsC,IAAH,GAAUG,QAAV,CAH4C,CAK1D;AACA;;AACAA,kCAAQ,CAAC1C,OAAT,CAAiB,UAAA2C,KAAK,EAAI;AACxB,gCAAIC,KAAK,GAAG3C,EAAE,CAACsC,IAAH,CAAQM,SAAR,CAAkB,UAAArC,CAAC;AAAA,qCAAIA,CAAC,CAAC/B,EAAF,KAASkE,KAAK,CAAClE,EAAf,IAAqB+B,CAAC,CAACnC,eAAF,KAAsBsE,KAAK,CAACtE,eAArD;AAAA,6BAAnB,CAAZ;;AACA,gCAAIuE,KAAK,IAAI,CAAb,EAAgB;AACd;AACA;AACA;AACA3C,gCAAE,CAACsC,IAAH,CAAQO,MAAR,CAAeF,KAAf,EAAsB,CAAtB,EAAyBD,KAAzB,EAJc,CAImB;AAClC,6BALD,MAKO;AACL1C,gCAAE,CAACsC,IAAH,CAAQQ,OAAR,CAAgBJ,KAAhB,EADK,CACmB;AACzB;AACF,2BAVD;AAWD;AACF,uBArBD;AAuBD;;;;;;;;AAEDZ,2BAAO,CAACC,GAAR,CAAY,MAAZ;;;;;;;;;AAGH;AAED;;;;;;AAhJqB;AAAA;AAAA,oCAqJTgB,EArJS,EAqJLC,IArJK,EAqJC;AAAA;;AACpB;AACA,cAAIC,IAAI,GAAG,CACT;AACEC,gBAAI,EAAE;AACJ/E,kBAAI,EAAE,QADF;AAEJgF,mBAAK,EAAE;AAFH,aADR;AAKEhF,gBAAI,EAAE,iBALR;AAMEF,iBAAK,EAAE;AANT,WADS,CAAX,CAFoB,CAapB;;AACA,eAAKY,SAAL,CAAeuE,cAAf,CACEL,EADF,EACM,0EADN,EAEI;AACAM,gBAAI,EAAE,eADN;AAEAC,iBAAK,EAAE,gBAFP;AAGAH,iBAAK,EAAE,SAHP;AAIAF,gBAAI,EAAEA;AAJN,WAFJ,EAQGM,IARH,CAQQ,UAAAC,IAAI,EAAI;AACZ;AACA,kBAAI,CAACC,cAAL,CAAoBD,IAApB,EAA0BR,IAA1B;AACD,WAXH,WAYS,UAAAU,GAAG,EAAI;AACZ5B,mBAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB2B,GAArB;AACD,WAdH;AAgBD;AAED;;;;;AArLqB;AAAA;AAAA,wCAyLLC,KAzLK,EAyLE;AAAA;;AAErB;AACA,cAAIV,IAAJ;;AAEA,cAAI,CAACU,KAAK,CAACX,IAAN,CAAWX,SAAhB,EAA2B;AACzBY,gBAAI,GAAG,CACL;AACEC,kBAAI,EAAE;AACJ/E,oBAAI,EAAE,WADF;AAEJgF,qBAAK,EAAE;AAFH,eADR;AAKEhF,kBAAI,EAAE,mBALR;AAMEF,mBAAK,EAAE;AANT,aADK,EAUL;AACEiF,kBAAI,EAAE;AACJ/E,oBAAI,EAAE,OADF;AAEJgF,qBAAK,EAAE;AAFH,eADR;AAKEhF,kBAAI,EAAEwF,KAAK,CAACX,IAAN,CAAWY,MAAX,KAAsB,CAAtB,GAA0B,iBAA1B,GAA8C,mBALtD;AAME3F,mBAAK,EAAE;AANT,aAVK,CAAP;AAmBD,WApBD,MAoBO;AACLgF,gBAAI,GAAG,CACL;AACEC,kBAAI,EAAE;AACJ/E,oBAAI,EAAE,QADF;AAEJgF,qBAAK,EAAE;AAFH,eADR;AAKEhF,kBAAI,EAAE,cALR;AAMEF,mBAAK,EAAE;AANT,aADK,CAAP;AAUD,WApCoB,CAsCrB;;;AACA,eAAKY,SAAL,CAAeuE,cAAf,CACEO,KAAK,CAACA,KADR,EACe,0EADf,EAEI;AACAN,gBAAI,EAAE,eADN;AAEAC,iBAAK,EAAE,gBAFP;AAGAH,iBAAK,EAAE,SAHP;AAIAF,gBAAI,EAAEA;AAJN,WAFJ,EAQGM,IARH,CAQQ,UAAAC,IAAI,EAAI;AACZ;AACA,kBAAI,CAACC,cAAL,CAAoBD,IAApB,EAA0BG,KAAK,CAACX,IAAhC;AACD,WAXH,WAYS,UAAAU,GAAG,EAAI;AACZ5B,mBAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB2B,GAArB;AACD,WAdH;AAeD;AAED;;;;;;AAjPqB;AAAA;AAAA,uCAsPNG,GAtPM,EAsPDb,IAtPC,EAsPK;AAExB;AACA,cAAIa,GAAG,CAAC5F,KAAJ,KAAc,WAAlB,EAA+B;AAC7B,gBAAI6F,OAAO,GAAG;AACZtF,gBAAE,EAAE,CAAC,CADO;AAEZJ,6BAAe,EAAE4E,IAAI,CAACxE,EAFV;AAGZuF,wBAAU,EAAE,QAHA;AAIZC,oBAAM,EAAE,EAJI;AAKZC,wBAAU,EAAEjB,IAAI,CAAC7E,IALL,CAKU;;AALV,aAAd;AAQA,iBAAK+F,UAAL,CAAgBJ,OAAhB,EAAyB,KAAzB;AACD,WAbuB,CAexB;;;AACA,cAAID,GAAG,CAAC5F,KAAJ,KAAc,YAAlB,EAAgC;AAC9B+E,gBAAI,CAACe,UAAL,GAAkB,QAAlB,CAD8B,CACM;;AACpCf,gBAAI,CAACgB,MAAL,GAAc,CAAC,IAAD,CAAd,CAF8B,CAEK;;AACnChB,gBAAI,CAACiB,UAAL,GAAkBjB,IAAI,CAAC3E,iBAAvB;AAEA,iBAAK6F,UAAL,CAAgBlB,IAAhB,EAAsB,MAAtB;AACD,WAtBuB,CAyBxB;;;AACA,cAAIa,GAAG,CAAC5F,KAAJ,KAAc,YAAlB,EAAgC;AAE9B+E,gBAAI,CAACe,UAAL,GAAkB,QAAlB,CAF8B,CAEF;;AAC5Bf,gBAAI,CAACgB,MAAL,GAAc,CAAC,IAAD,CAAd,CAH8B,CAGH;;AAE3B,iBAAKG,QAAL,CAAcnB,IAAd;AACD;AAEF;AAED;;;;;AA1RqB;AAAA;AAAA,mCA8RVA,IA9RU,EA8RJK,IA9RI,EA8RE;AAErB;AAEA,cAAIe,UAAU,GAAG,EAAjB,CAJqB,CAKrB;;AACA,cAAIxE,KAAK,CAACC,OAAN,CAAc,KAAK8B,aAAnB,CAAJ,EAAuC;AACrC,iBAAKA,aAAL,CAAmB5B,OAAnB,CAA2B,UAAAC,EAAE,EAAI;AAC/BoE,wBAAU,CAACnE,IAAX,CACE;AAAE9B,oBAAI,EAAE6B,EAAE,CAAC7B,IAAX;AAAiBF,qBAAK,EAAEiC,QAAQ,CAACF,EAAE,CAACxB,EAAJ;AAAhC,eADF;AAGD,aAJD;AAKD,WAZoB,CAcrB;;;AACA,cAAIkB,UAAU,GAAG,EAAjB,CAfqB,CAgBrB;;AACA,cAAIC,cAAc,GAAG,EAArB;;AAEA,cAAIC,KAAK,CAACC,OAAN,CAAc,KAAKC,QAAnB,CAAJ,EAAkC;AAChC,iBAAKA,QAAL,CAAcC,OAAd,CAAsB,UAAAC,EAAE,EAAI;AAC1B;AACA,kBAAIA,EAAE,CAAC5B,eAAH,KAAuB4E,IAAI,CAAC5E,eAAhC,EAAiD;AAE/C;AACAsB,0BAAU,CAACO,IAAX,CAAgB;AAAE9B,sBAAI,EAAE6B,EAAE,CAAC7B,IAAX;AAAiBF,uBAAK,EAAEiC,QAAQ,CAACF,EAAE,CAACxB,EAAJ;AAAhC,iBAAhB,EAH+C,CAK/C;;AACA,oBAAIwB,EAAE,CAACxB,EAAH,KAAUwE,IAAI,CAAC1E,MAAnB,EAA2B;AACzBqB,gCAAc,CAACM,IAAf,CAAoB;AAAE9B,wBAAI,EAAE6B,EAAE,CAAC7B,IAAX;AAAiBF,yBAAK,EAAEiC,QAAQ,CAACF,EAAE,CAACxB,EAAJ;AAAhC,mBAApB;AACD;AACF;AACF,aAZD;AAaD,WAjCoB,CAmCrB;;;AACA,cAAI6F,QAAQ,GAAG,EAAf;;AACA,cAAIrB,IAAI,CAACvE,QAAT,EAAmB;AACjBuE,gBAAI,CAACvE,QAAL,CAAcsB,OAAd,CAAsB,UAAAC,EAAE,EAAI;AAC1BqE,sBAAQ,CAACpE,IAAT,CAAc,KAAKD,EAAnB;AACD,aAFD;AAGD;;AAED,cAAIsE,IAAI,GAAG;AACThB,iBAAK,EAAE,CAACD,IAAI,KAAK,KAAT,GAAiB,MAAjB,GAA0B,KAA3B,IAAoC,WADlC;AAEPkB,mBAAO,EAAE,CACT;AAAEpB,mBAAK,EAAE,QAAT;AAAmBD,kBAAI,EAAE,OAAzB;AAAkCzC,kBAAI,EAAE;AAAxC,aADS,CAFF;AAKP+D,iBAAK,EAAE,CACP;AAAEnB,kBAAI,EAAE,OAAR;AAAiBlF,kBAAI,EAAE6E,IAAI,CAACiB;AAA5B,aADO,EAEL;AAAEZ,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,IAAvB;AAA6BxB,mBAAK,EAAE+E,IAAI,CAACxE;AAAzC,aAFK,EAGL;AAAE6E,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,iBAAvB;AAA0CxB,mBAAK,EAAE+E,IAAI,CAAC5E;AAAtD,aAHK,EAIL;AAAEiF,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,YAAvB;AAAqCxB,mBAAK,EAAE+E,IAAI,CAACe;AAAjD,aAJK,EAKL;AAAEV,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,QAAvB;AAAiCxB,mBAAK,EAAE+E,IAAI,CAACgB;AAA7C,aALK,CAOP;AAPO,cAQL;AAAEX,kBAAI,EAAE,MAAR;AAAgB5D,iBAAG,EAAE,MAArB;AAA6BxB,mBAAK,EAAE+E,IAAI,CAAC7E,IAAzC;AAA+CA,kBAAI,EAAE,WAArD;AAAkEsG,wBAAU,EAAE,MAA9E;AAAsFvB,kBAAI,EAAE,SAA5F;AAAuGwB,wBAAU,EAAE,CAAC;AAAEC,wBAAQ,EAAE,IAAZ;AAAkBC,mBAAG,EAAE,CAAvB;AAA0BC,mBAAG,EAAE;AAA/B,eAAD,CAAnH;AAA2JC,kBAAI,EAAE;AAAjK,aARK,EASL;AAAEzB,kBAAI,EAAE,eAAR;AAAyB5D,iBAAG,EAAE,iBAA9B;AAAiDtB,kBAAI,EAAE,cAAvD;AAAuEF,mBAAK,EAAE,KAAK+E,IAAI,CAAC5E,eAAxF;AAAyG2G,qBAAO,EAAEX,UAAlH;AAA8HlB,kBAAI,EAAE,cAApI;AAAoJwB,wBAAU,EAAE,CAAC;AAAEC,wBAAQ,EAAE;AAAZ,eAAD,CAAhK;AAAsLG,kBAAI,EAAE;AAA5L,aATK,EAUL;AAAEzB,kBAAI,EAAE,eAAR;AAAyB5D,iBAAG,EAAE,QAA9B;AAAwCtB,kBAAI,EAAE,WAA9C;AAA2DF,mBAAK,EAAE+E,IAAI,CAAC1E,MAAL,GAAc,KAAK0E,IAAI,CAAC1E,MAAxB,GAAiC0G,SAAnG;AAA8GD,qBAAO,EAAErF,UAAvH;AAAmIwD,kBAAI,EAAE,gBAAzI;AAA2JwB,wBAAU,EAAE,CAAC;AAAEC,wBAAQ,EAAE;AAAZ,eAAD,CAAvK;AAA6LG,kBAAI,EAAE;AAAnM,aAVK,EAWL;AAAEzB,kBAAI,EAAE,wBAAR;AAAkC5D,iBAAG,EAAE,UAAvC;AAAmDtB,kBAAI,EAAE,sBAAzD;AAAiFF,mBAAK,EAAEoG,QAAxF;AAAkGU,qBAAO,EAAEpF,cAA3G;AAA2HuD,kBAAI,EAAE,aAAjI;AAAgJ4B,kBAAI,EAAE;AAAtJ,aAXK,EAYL;AACAzB,kBAAI,EAAE,QADN;AAEE0B,qBAAO,EAAE,CACT;AAAE5G,oBAAI,EAAE,OAAR;AAAiBsC,oBAAI,EAAE;AAAvB,eADS,EAEP;AACAtC,oBAAI,EAAEkF,IAAI,KAAK,KAAT,GAAiB,SAAjB,GAA6B,WADnC;AACgD5C,oBAAI,EAAE,UADtD;AAEEwE,mBAAG,EAAE,KAAKrG,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GACH;AAHJ,eAFO;AAFX,aAZK;AALA,WAAX;AA+BA,eAAK7C,SAAL,CAAeqG,SAAf,CAAyB,2EAAzB,EAAgD;AAC9CC,kBAAM,EAAE,IADsC;AAE9Cb,gBAAI,EAAEA,IAFwC;AAG9Cc,oBAAQ,EAAE,KAAKrG;AAH+B,WAAhD;AAMD;AAED;;;;;AAhXqB;AAAA;AAAA,iCAoXZiE,IApXY,EAoXN;AACb,cAAIsB,IAAI,GAAG;AACThB,iBAAK,EAAE,qBADE;AAEP+B,wBAAY,EAAE,IAFP;AAGPd,mBAAO,EAAE,CACT;AAAEpB,mBAAK,EAAE,QAAT;AAAmBD,kBAAI,EAAE,OAAzB;AAAkCzC,kBAAI,EAAE;AAAxC,aADS,CAHF;AAMP+D,iBAAK,EAAE,CACP;AAAEnB,kBAAI,EAAE,OAAR;AAAiBlF,kBAAI,EAAE6E,IAAI,CAAC7E;AAA5B,aADO,EAEL;AAAEkF,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,IAAvB;AAA6BxB,mBAAK,EAAE+E,IAAI,CAACxE;AAAzC,aAFK,CAEyC;AAFzC,cAGL;AAAE6E,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,YAAvB;AAAqCxB,mBAAK,EAAE+E,IAAI,CAACe;AAAjD,aAHK,EAIL;AAAEV,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,QAAvB;AAAiCxB,mBAAK,EAAE+E,IAAI,CAACgB;AAA7C,aAJK,EAKL;AAAEX,kBAAI,EAAE,UAAR;AAAoB5D,iBAAG,EAAE,cAAzB;AAAyCxB,mBAAK,EAAE+E,IAAI,CAACsC,YAArD;AAAmEnH,kBAAI,EAAE,+BAAzE;AAA0GoH,qBAAO,EAAE,YAAnH;AAAiIC,oBAAM,EAAE;AAAzI,aALK,EAML;AAAEnC,kBAAI,EAAE,QAAR;AAAkB5D,iBAAG,EAAE,QAAvB;AAAiCtB,kBAAI,EAAE6E,IAAI,CAACY,MAAL,GAAc,YAAd,GAA6B,YAApE;AAAkF3F,mBAAK,EAAE+E,IAAI,CAACY,MAA9F;AAAsGT,mBAAK,EAAE,WAA7G;AAA0HD,kBAAI,EAAE;AAAhI,aANK,EAOL;AACAG,kBAAI,EAAE,QADN;AAEE0B,qBAAO,EAAE,CACT;AACE5G,oBAAI,EAAE,UADR;AACoBsC,oBAAI,EAAE,UAD1B;AACsCwE,mBAAG,EAAE,KAAKrG,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GACrC;AAFN,eADS;AAFX,aAPK;AANA,WAAX;AAyBA,eAAK7C,SAAL,CAAeqG,SAAf,CAAyB,2EAAzB,EAAgD;AAC9CC,kBAAM,EAAE,IADsC;AAE9Cb,gBAAI,EAAEA,IAFwC;AAG9Cc,oBAAQ,EAAE,KAAKrG;AAH+B,WAAhD;AAKD;AAnZoB;AAAA;AAAA,0CAsfG;;;;;;;;;AAClB0G,gC,GAAe,KAAK7G,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GAA2C,2C;;AAC/C,2BAAM,KAAK9C,OAAL,CAAa4C,aAAb,CAA2BiE,YAA3B,EAAyC,EAAzC,EAA6C;AAAEC,kCAAY,EAAE;AAAhB,qBAA7C,CAAN;;;AAAXC,4B;AACAC,sB,GAAK,IAAIC,UAAJ,E;AACTD,sBAAE,CAACE,iBAAH,CAAqBH,QAArB;;AACAC,sBAAE,CAACG,SAAH,GAAe;AAAA,6BAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AACrBC,0CADqB,GACHJ,EAAE,CAAC5E,MADA;AAErBiF,kCAFqB,GAEhB,IAAI,gDAAJ,EAFgB;AAAA;AAGV,uCAAMA,EAAE,CAACC,IAAH,CAAQC,IAAR,CAAaH,UAAb,CAAN;;AAHU;AAGrBI,wCAHqB;AAIzB;AACAA,wCAAQ,CAACC,SAAT,CAAmB,UAAAC,KAAK,EAAI;AAC1B,sCAAIA,KAAK,CAACnI,IAAN,IAAcJ,MAAM,CAACC,UAAP,CAAkBC,KAApC,EAA2CqI,KAAK,CAACC,KAAN,GAAc,QAAd;AAC5C,iCAFD;AAGIC,yCARqB,GAQTJ,QAAQ,CAACK,YAAT,CAAsB1I,MAAM,CAACC,UAAP,CAAkBC,KAAxC,CARS;AAUrByI,mCAVqB,GAUfF,SAAS,CAACG,MAAV,CAAiB,CAAjB,CAVe;AAWzBD,mCAAG,CAACE,OAAJ,CAAY,GAAZ,EAAiB3I,KAAjB,GAAyB,KAAK+D,iBAAL,CAAuB,CAAvB,EAA0B7D,IAAnD;AACAuI,mCAAG,CAACE,OAAJ,CAAY,GAAZ,EAAiB3I,KAAjB,GAAyB,KAAK+D,iBAAL,CAAuB,CAAvB,EAA0BxD,EAAnD,CAZyB,CAczB;;AACAgI,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBC,KAAvB,GAA+B,CAA/B;AACAN,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBC,KAAvB,GAA+B,EAA/B;AACAN,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBC,KAAvB,GAA+B,EAA/B;AACAN,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBC,KAAvB,GAA+B,EAA/B;AACAN,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBC,KAAvB,GAA+B,EAA/B;AACAN,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBC,KAAvB,GAA+B,EAA/B,CApByB,CAsBzB;;AACAN,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBE,SAAvB,GAAmC;AAAEC,0CAAQ,EAAE;AAAZ,iCAAnC;AACAR,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBE,SAAvB,GAAmC;AAAEC,0CAAQ,EAAE;AAAZ,iCAAnC;AACAR,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBE,SAAvB,GAAmC;AAAEC,0CAAQ,EAAE;AAAZ,iCAAnC;AACAR,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBE,SAAvB,GAAmC;AAAEC,0CAAQ,EAAE;AAAZ,iCAAnC;AACAR,yCAAS,CAACK,SAAV,CAAoB,CAApB,EAAuBE,SAAvB,GAAmC;AAAEC,0CAAQ,EAAE;AAAZ,iCAAnC;AAEIC,mCA7BqB,GA6Bf,CA7Be,EA8BzB;;AACA,qCAAK/E,MAAL,CAAYnC,OAAZ,CAAoB,UAAAC,EAAE,EAAI;AACxB0G,qCAAG,GAAGF,SAAS,CAACG,MAAV,CAAiBM,GAAjB,CAAN;AACAP,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACG,IAAP,CAAYD,KAAxB,EAA+BA,KAA/B,GAAuCgJ,GAAG,GAAG,CAA7C;AACAP,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACI,IAAP,CAAYF,KAAxB,EAA+BA,KAA/B,GAAuC+B,EAAE,CAAC7B,IAA1C;AACAuI,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACK,eAAP,CAAuBH,KAAnC,EAA0CA,KAA1C,GAAkD+B,EAAE,CAAC5B,eAArD;AACAsI,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACM,iBAAP,CAAyBJ,KAArC,EAA4CA,KAA5C,GAAoD+B,EAAE,CAAC3B,iBAAvD;AACAqI,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACO,MAAP,CAAcL,KAA1B,EAAiCA,KAAjC,GAAyC+B,EAAE,CAAC1B,MAA5C;AACAoI,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACQ,QAAP,CAAgBN,KAA5B,EAAmCA,KAAnC,GAA2C+B,EAAE,CAACzB,QAA9C;AACAmI,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACS,EAAP,CAAUP,KAAtB,EAA6BA,KAA7B,GAAqC+B,EAAE,CAACxB,EAAxC;AACAkI,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACU,QAAP,CAAgBR,KAA5B,EAAmCA,KAAnC,GAA2C+B,EAAE,CAACvB,QAA9C;AACAiI,qCAAG,CAACE,OAAJ,CAAY7I,MAAM,CAACW,aAAP,CAAqBT,KAAjC,EAAwCA,KAAxC,GAAgD+B,EAAE,CAACtB,aAAnD;AACAuI,qCAAG;AACJ,iCAZD;AAcAb,wCAAQ,CAACc,KAAT,GAAiB,CACf;AACE3G,mCAAC,EAAE,CADL;AACQ4G,mCAAC,EAAE,CADX;AACcL,uCAAK,EAAE,KADrB;AAC4BM,wCAAM,EAAE,KADpC;AAEEC,4CAAU,EAAE,CAFd;AAEiBC,2CAAS,EAAE,CAF5B;AAE+BC,4CAAU,EAAE;AAF3C,iCADe,CAAjB,CA7CyB,CAoDzB;;AACAnB,wCAAQ,CAACF,IAAT,CAAcsB,WAAd,GAA4BjE,IAA5B,CAAiC,UAACC,IAAD,EAAU;AACzC,sCAAIiE,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAAClE,IAAD,CAAT,EAAiB;AAAEH,wCAAI,EAAE;AAAR,mCAAjB,CAAX;AACA,oFAAUoE,IAAV,yBAAgCE,IAAI,CAACC,GAAL,EAAhC;AACD,iCAHD;;AArDyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAZ;AAAA,qBAAf;;;;;;;;;AA0DD;AArjBoB;AAAA;AAAA,sCAujBP7E,EAvjBO,EAujBH;AAAA;;AAChB,cAAI8E,MAAM,GAAG9E,EAAE,CAAC+E,MAAH,CAAUC,KAAvB,CADgB,CAEhB;;AACA,cAAInC,EAAE,GAAG,IAAIC,UAAJ,EAAT;AACAD,YAAE,CAACE,iBAAH,CAAqB+B,MAAM,CAAC,CAAD,CAA3B;;AACAjC,YAAE,CAACG,SAAH,GAAe;AAAA,mBAAY;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AACrBC,gCADqB,GACHJ,EAAE,CAAC5E,MADA;AAErBiF,wBAFqB,GAEhB,IAAI,gDAAJ,EAFgB;AAAA;AAAA;AAIR,6BAAMA,EAAE,CAACC,IAAH,CAAQC,IAAR,CAAaH,UAAb,CAAN;;AAJQ;AAInBI,8BAJmB;AAKnBI,+BALmB,GAKPJ,QAAQ,CAACK,YAAT,CAAsB1I,MAAM,CAACC,UAAP,CAAkBC,KAAxC,CALO;AAMnB+J,6BANmB,GAMT,EANS;AAOvBxB,+BAAS,CAACyB,OAAV,CAAkB,UAACvB,GAAD,EAAMwB,QAAN,EAAmB;AACnC,4BAAIA,QAAQ,GAAG,CAAf,EAAkB;AAChB,8BAAIC,IAAI,GAAG,EAAX;;AACA,+BAAK,IAAI1I,GAAT,IAAgB1B,MAAhB,EAAwB;AACtB,gCAAIiF,IAAI,GAAGjF,MAAM,CAAC0B,GAAD,CAAjB;;AACA,gCAAIA,GAAG,IAAI,YAAX,EAAyB;AACvB2I,oCAAM,CAACC,cAAP,CAAsBF,IAAtB,EACI1I,GADJ,EAEI;AAAExB,qCAAK,EAAE,MAAI,CAACqK,eAAL,CAAqB5B,GAAG,CAAC6B,MAAJ,CAAW,MAAI,CAAC5H,sBAAL,CAA4BqC,IAAI,CAAC/E,KAAjC,CAAX,CAArB;AAAT,+BAFJ;AAGD;AACF;;AACD+J,iCAAO,CAAC/H,IAAR,CAAakI,IAAb;AACD;AACF,uBAbD,EAPuB,CAqBvB;;AACIK,kCAtBmB,GAsBJ;AAAEC,qCAAa,EAAE,CAAjB;AAAoBC,kCAAU,EAAE;AAAhC,uBAtBI,EAuBvB;;AACIC,6BAxBmB,GAwBT,SAAVA,OAAU,CAACnK,EAAD,EAAKoK,GAAL,EAAa;AAAA,mEACVA,GADU;AAAA;;AAAA;AACzB,8EAAoB;AAAA,gCAAX5I,EAAW;AAClB,gCAAIxB,EAAE,KAAKwB,EAAE,CAACxB,EAAd,EAAkB,OAAO,IAAP;AACnB;AAHwB;AAAA;AAAA;AAAA;AAAA;;AAIzB,+BAAO,KAAP;AACD,uBA7BsB;;AAAA,yCA8BNwJ,OA9BM;;AAAA;AAAA;AAAA;AAAA;AAAA;;AA8BZhI,wBA9BY;;AAAA,2BA+BjB2I,OAAO,CAAC3I,EAAE,CAAC5B,eAAJ,EAAqB,KAAK6D,OAA1B,CA/BU;AAAA;AAAA;AAAA;;AAgCf4G,8BAhCe,GAgCJ;AACbrK,0BAAE,EAAEwB,EAAE,CAACxB,EADM;AAEbJ,uCAAe,EAAE4B,EAAE,CAAC5B,eAFP;AAGbD,4BAAI,EAAE6B,EAAE,CAAC7B,IAHI;AAIbG,8BAAM,EAAE0B,EAAE,CAAC1B,MAJE;AAKbG,gCAAQ,EAAEuB,EAAE,CAACvB;AALA,uBAhCI,EAuCnB;;AAvCmB;AAAA;AAyCjB,6BAAM,KAAKG,OAAL,CAAakK,eAAb,CAA6B,KAAKlK,OAAL,CAAa6C,WAAb,CAAyBC,eAAzB,GAC/B,cADE,EACcmH,QADd,CAAN;;AAzCiB;AA2CjBL,kCAAY,CAACC,aAAb;AA3CiB;AAAA;;AAAA;AAAA;AAAA;AA6CjB;AACAD,kCAAY,CAACE,UAAb;;AA9CiB;AAAA;AAAA;AAAA;;AAAA;AAkDvB5G,6BAAO,CAACC,GAAR,CAAYyG,YAAZ,EAlDuB,CAmDvB;;AACA,2BAAK1J,MAAL,CAAY0B,IAAZ,CAAiB,mBAAjB;AApDuB;AAAA;;AAAA;AAAA;AAAA;AAuDvBsB,6BAAO,CAACC,GAAR,CAAY,2BAAZ;;AAvDuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAZ;AAAA,WAAf;AA4DD;AAxnBoB;AAAA;AAAA,wCAkoBLgH,GAloBK,EAkoBA;AACnB,cAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK/D,SAA5B,EAAuC,OAAO,IAAP;;AACvC,cAAI,OAAO+D,GAAP,KAAe,QAAnB,EAA6B;AAC3B;AACA,gBAAIA,GAAG,CAACC,QAAR,EAAkB,OAAOD,GAAG,CAACC,QAAJ,CAAaC,GAAb,CAAiB,UAAAC,CAAC;AAAA,qBAAIA,CAAC,CAAC,MAAD,CAAL;AAAA,aAAlB,EAAiCC,IAAjC,CAAsC,EAAtC,CAAP,CAFS,CAG3B;;AACA,mBAAOJ,GAAG,CAAC/H,MAAX;AACD;;AACD,iBAAO+H,GAAP;AACD;AA3oBoB;;AAAA;AAAA,OAAvB;;;;cAeqB;;cACI;;cACH;;;;AAjBTpK,cAAU,6DALtB,gEAAU;AACTyK,cAAQ,EAAE,YADD;AAETC,cAAQ,EAAR;AAAA;AAAA,kGAFS;;;;AAAA,KAAV,CAKsB,E,+EAeF,iE,EACI,oE,EACH,oD,EAjBC,GAAV1K,UAAU,CAAV","file":"pages-staffs-staffs-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n      <ion-back-button></ion-back-button>\\r\\n      <ion-button>\\r\\n        <input class=\\\"file-over\\\" type=\\\"file\\\" (change)=\\\"onClickUpload($event)\\\"\\r\\n          accept=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\\\" />\\r\\n        <ion-icon name=\\\"cloud-upload\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-title>CÂY NHÂN SỰ</ion-title>\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-button (click)=\\\"onClickDownload()\\\">\\r\\n        <ion-icon name=\\\"cloud-download\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content class=\\\"ion-no-padding\\\">\\r\\n  <ion-row>\\r\\n    <ion-col class=\\\"ion-text-center\\\" size=\\\"12\\\" class=\\\"card-prospect\\\" *ngFor=\\\"let item of organizationsTree\\\"\\r\\n      [style.background]=\\\"'#fafafaf6'\\\">\\r\\n\\r\\n      <ion-row (click)=\\\"onClickSpec($event, item)\\\">\\r\\n        <ion-col size=\\\"10\\\" class=\\\"prospect-header\\\" [style.color]=\\\"'darkblue'\\\">\\r\\n          <ion-icon item-start *ngIf=\\\"item.click_type\\\" style=\\\"font-size: 1em\\\" [style.color]=\\\"'lightblue'\\\"\\r\\n            name=\\\"md-cloud-upload\\\"></ion-icon>{{item.name}}\\r\\n        </ion-col>\\r\\n        <ion-col size=\\\"2\\\" class=\\\"prospect-header\\\" [style.color]=\\\"'darkblue'\\\">\\r\\n          {{item.id}}\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n\\r\\n      <tree-list [treeData]=\\\"item.subs\\\" (onClickKpi)=\\\"onClickTreeItem($event)\\\"></tree-list>\\r\\n\\r\\n    </ion-col>\\r\\n\\r\\n  </ion-row>\\r\\n</ion-content>\\r\\n\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { StaffsPage } from './staffs.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: StaffsPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class StaffsPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\n\r\nimport { StaffsPageRoutingModule } from './staffs-routing.module';\r\n\r\nimport { StaffsPage } from './staffs.page';\r\nimport { SharedModule } from 'src/app/shared.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    SharedModule,\r\n    StaffsPageRoutingModule\r\n  ],\r\n  declarations: [StaffsPage]\r\n})\r\nexport class StaffsPageModule {}\r\n","export default \".card-title-header {\\n  font-size: 1.5em;\\n  width: 90%;\\n  font-weight: bold;\\n  color: darkblue;\\n  text-transform: uppercase;\\n  opacity: 0.7;\\n}\\n\\n.card-prospect {\\n  border-radius: 0.8em;\\n  border: solid 0.15em #FFFFFF;\\n  width: 100%;\\n}\\n\\n.card-prospect .prospect-header {\\n  font-size: 1.2em;\\n  width: 100%;\\n  font-weight: bold;\\n  text-transform: uppercase;\\n  opacity: 0.9;\\n}\\n\\n.table-row .table-header {\\n  background: #99b7f0e0 !important;\\n  color: #0a0909fb !important;\\n  font-weight: bold;\\n}\\n\\n.table-row ion-col {\\n  border: solid 0.1em #FFFFFF;\\n  font-size: 1.3em;\\n}\\n\\n.table-row ion-row:nth-of-type(odd) {\\n  background: #fafafaf6;\\n  color: #202020;\\n  opacity: 0.9;\\n}\\n\\n.table-row ion-row:nth-of-type(even) {\\n  background: #e6f5f8;\\n  color: #202020;\\n  opacity: 0.7;\\n}\\n\\n.file-over {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 2;\\n  width: 100%;\\n  height: 100%;\\n  opacity: 1;\\n  cursor: pointer;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvc3RhZmZzL0U6XFxNWURBVEFcXExBUFRSSU5IXFxOT0RFNFxcbm9kZTQtcWxuc1xcY2xpZW50L3NyY1xcYXBwXFxwYWdlc1xcc3RhZmZzXFxzdGFmZnMucGFnZS5zY3NzIiwic3JjL2FwcC9wYWdlcy9zdGFmZnMvc3RhZmZzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQTtFQUNJLGdCQUFBO0VBQ0EsVUFBQTtFQUNBLGlCQUFBO0VBQ0EsZUFBQTtFQUNBLHlCQUFBO0VBQ0EsWUFBQTtBQ0FKOztBRElBO0VBQ0ksb0JBQUE7RUFDQSw0QkFBQTtFQUNBLFdBQUE7QUNESjs7QURLQTtFQUNJLGdCQUFBO0VBQ0EsV0FBQTtFQUNBLGlCQUFBO0VBQ0EseUJBQUE7RUFDQSxZQUFBO0FDRko7O0FETUE7RUFDSSxnQ0FBQTtFQUNBLDJCQUFBO0VBQ0EsaUJBQUE7QUNISjs7QURNQTtFQUNJLDJCQUFBO0VBQ0EsZ0JBQUE7QUNISjs7QURNQTtFQUNJLHFCQUFBO0VBQ0EsY0FBQTtFQUNBLFlBQUE7QUNISjs7QURNQTtFQUNJLG1CQUFBO0VBQ0EsY0FBQTtFQUNBLFlBQUE7QUNISjs7QURNQTtFQUNJLGtCQUFBO0VBQ0EsTUFBQTtFQUNBLE9BQUE7RUFDQSxVQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxVQUFBO0VBQ0EsZUFBQTtBQ0hKIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvc3RhZmZzL3N0YWZmcy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIvL3RoaeG6v3QgbOG6rXAgY2jhu68gY2hvIHRpw6p1IMSR4buBIGPDtG5nIHR5XHJcbi5jYXJkLXRpdGxlLWhlYWRlciB7XHJcbiAgICBmb250LXNpemU6IDEuNWVtO1xyXG4gICAgd2lkdGg6IDkwJTtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgY29sb3I6IGRhcmtibHVlO1xyXG4gICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcclxuICAgIG9wYWNpdHk6IDAuNztcclxufVxyXG5cclxuLy9UaGnhur90IGzhuq1wIGtodW5nIG7hu4FuIHbDoCBj4buhIGNo4buvIGNobyBjYXJkIHZp4buFbiBj4bqjbmhcclxuLmNhcmQtcHJvc3BlY3R7XHJcbiAgICBib3JkZXItcmFkaXVzOiAwLjhlbTtcclxuICAgIGJvcmRlcjogc29saWQgMC4xNWVtICNGRkZGRkY7XHJcbiAgICB3aWR0aDoxMDAlO1xyXG4gICAgLy9vcGFjaXR5OiAwLjg7XHJcbn1cclxuXHJcbi5jYXJkLXByb3NwZWN0IC5wcm9zcGVjdC1oZWFkZXIge1xyXG4gICAgZm9udC1zaXplOiAxLjJlbTtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xyXG4gICAgb3BhY2l0eTogMC45O1xyXG59XHJcblxyXG4vL1RoaeG6v3QgbOG6rXAgZMOybmcgY2jhurVuIGzhursgY2hvIGLhuqNuZ1xyXG4udGFibGUtcm93IC50YWJsZS1oZWFkZXIgeyAvL3ThuqV0IGPhuqMgY8OhYyBj4buZdCBzYXUgY2xhc3MgbsOgeVxyXG4gICAgYmFja2dyb3VuZDogIzk5YjdmMGUwICFpbXBvcnRhbnQ7XHJcbiAgICBjb2xvcjojMGEwOTA5ZmIgIWltcG9ydGFudDtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG59XHJcblxyXG4udGFibGUtcm93IGlvbi1jb2wgeyAvL3ThuqV0IGPhuqMgY8OhYyBj4buZdCBzYXUgY2xhc3MgbsOgeVxyXG4gICAgYm9yZGVyOiBzb2xpZCAwLjFlbSAjRkZGRkZGO1xyXG4gICAgZm9udC1zaXplOiAxLjNlbTtcclxufVxyXG5cclxuLnRhYmxlLXJvdyBpb24tcm93Om50aC1vZi10eXBlKG9kZCkgeyAvL2TDsm5nIGzhurtcclxuICAgIGJhY2tncm91bmQ6ICNmYWZhZmFmNjtcclxuICAgIGNvbG9yOiMyMDIwMjA7XHJcbiAgICBvcGFjaXR5OiAwLjk7XHJcbn1cclxuXHJcbi50YWJsZS1yb3cgaW9uLXJvdzpudGgtb2YtdHlwZShldmVuKSB7IC8vZMOybmcgY2jhurVuXHJcbiAgICBiYWNrZ3JvdW5kOiAjZTZmNWY4O1xyXG4gICAgY29sb3I6IzIwMjAyMDtcclxuICAgIG9wYWNpdHk6IDAuNztcclxufVxyXG5cclxuLmZpbGUtb3ZlciB7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0b3A6IDA7XHJcbiAgICBsZWZ0OiAwO1xyXG4gICAgei1pbmRleDogMjtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgb3BhY2l0eTogMTtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxufSIsIi5jYXJkLXRpdGxlLWhlYWRlciB7XG4gIGZvbnQtc2l6ZTogMS41ZW07XG4gIHdpZHRoOiA5MCU7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICBjb2xvcjogZGFya2JsdWU7XG4gIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gIG9wYWNpdHk6IDAuNztcbn1cblxuLmNhcmQtcHJvc3BlY3Qge1xuICBib3JkZXItcmFkaXVzOiAwLjhlbTtcbiAgYm9yZGVyOiBzb2xpZCAwLjE1ZW0gI0ZGRkZGRjtcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi5jYXJkLXByb3NwZWN0IC5wcm9zcGVjdC1oZWFkZXIge1xuICBmb250LXNpemU6IDEuMmVtO1xuICB3aWR0aDogMTAwJTtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gIG9wYWNpdHk6IDAuOTtcbn1cblxuLnRhYmxlLXJvdyAudGFibGUtaGVhZGVyIHtcbiAgYmFja2dyb3VuZDogIzk5YjdmMGUwICFpbXBvcnRhbnQ7XG4gIGNvbG9yOiAjMGEwOTA5ZmIgIWltcG9ydGFudDtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG59XG5cbi50YWJsZS1yb3cgaW9uLWNvbCB7XG4gIGJvcmRlcjogc29saWQgMC4xZW0gI0ZGRkZGRjtcbiAgZm9udC1zaXplOiAxLjNlbTtcbn1cblxuLnRhYmxlLXJvdyBpb24tcm93Om50aC1vZi10eXBlKG9kZCkge1xuICBiYWNrZ3JvdW5kOiAjZmFmYWZhZjY7XG4gIGNvbG9yOiAjMjAyMDIwO1xuICBvcGFjaXR5OiAwLjk7XG59XG5cbi50YWJsZS1yb3cgaW9uLXJvdzpudGgtb2YtdHlwZShldmVuKSB7XG4gIGJhY2tncm91bmQ6ICNlNmY1Zjg7XG4gIGNvbG9yOiAjMjAyMDIwO1xuICBvcGFjaXR5OiAwLjc7XG59XG5cbi5maWxlLW92ZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgei1pbmRleDogMjtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgb3BhY2l0eTogMTtcbiAgY3Vyc29yOiBwb2ludGVyO1xufSJdfQ== */\";","import { Component, OnInit } from '@angular/core';\r\nimport { CommonsService, AuthService, PopoverCardComponent, DynamicFormMobilePage } from 'ngxi4-dynamic-service';\r\n\r\nimport * as Excel from \"exceljs\";\r\nimport * as fs from 'file-saver';\r\nimport { Socket } from 'ngx-socket-io';\r\n\r\nlet config = {\r\n  sheet_name: { value: 'staffs' }\r\n  , noId: { value: \"A\" }\r\n  , name: { value: \"B\" }\r\n  , organization_id: { value: \"C\" }\r\n  , organization_name: { value: \"D\" }\r\n  , job_id: { value: \"E\" }\r\n  , job_name: { value: \"F\" }\r\n  , id: { value: \"G\" }\r\n  , job_list: { value: \"H\" }\r\n  , job_list_name: { value: \"I\" }\r\n}\r\n\r\n@Component({\r\n  selector: 'app-staffs',\r\n  templateUrl: './staffs.page.html',\r\n  styleUrls: ['./staffs.page.scss'],\r\n})\r\nexport class StaffsPage implements OnInit {\r\n\r\n  organizationId: any;  //mã tổ chức của user\r\n  userReport: any;\r\n\r\n  organizations: any; //danh sách tổ chức lấy từ csdl\r\n  organizationsTree: any; //cây tổ chức hiển thị\r\n\r\n  jobRoles: any; //danh sách chức danh lấy từ csdl\r\n\r\n  staffs: any;//danh sách nhân sự lấy từ csdl\r\n\r\n  orgTree: any;//\r\n\r\n  constructor(\r\n    private apiAuth: AuthService\r\n    , private apiCommon: CommonsService\r\n    , private socket: Socket\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.refreshNews();\r\n    this.socket.on(\"server-staff-done\", () => {\r\n      this.onChangeSelect();\r\n    });\r\n  }\r\n\r\n  async refreshNews() {\r\n\r\n    try {\r\n      //Lấy danh sách tổ chức có trong csdl, \r\n      this.organizations = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-organizations\");\r\n\r\n      // console.log('Organization', this.organizations);\r\n\r\n\r\n      //lấy mã tổ chức của username: 0766777123\r\n      this.userReport = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-user-report\");\r\n\r\n      // console.log('get-user-report', this.userReport);\r\n\r\n      //mã tổ chức của user\r\n      this.organizationId = this.userReport && this.userReport.organization_id ? this.userReport.organization_id : 0;\r\n\r\n      //lấy danh sách chức danh từ csdl\r\n      this.jobRoles = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-job-roles\");\r\n\r\n      // console.log('get-job-roles', this.jobRoles);\r\n\r\n    } catch (e) {\r\n      console.log('Lỗi', e);\r\n    }\r\n\r\n    this.onChangeSelect();\r\n  }\r\n\r\n  /**\r\n   * Khi có thay đổi thêm/sửa/xóa\r\n   */\r\n  async onChangeSelect() {\r\n\r\n    //cây tổ chức\r\n    this.organizationsTree = [];\r\n    this.orgTree = [];\r\n\r\n    try {\r\n      //lấy danh sách nhân sự\r\n      this.staffs = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-staffs\");\r\n      this.staffs.forEach(el => {\r\n        if (el.job_list_name) {\r\n          let name = []\r\n          el.job_list_name.forEach(el => {\r\n            name.push(el.name)\r\n          });\r\n          el.job_list_name = name\r\n        }\r\n      });\r\n      // console.log(this.staffs);\r\n\r\n      if (Array.isArray(this.staffs)) {\r\n\r\n        // Lọc danh sách nhân sự theo mã tổ chức của user\r\n        this.organizations.forEach(el => {\r\n          if (el.id === this.organizationId) {\r\n            this.orgTree.push(el)\r\n          }\r\n          if (el.parent_id === this.organizationId) {\r\n            this.orgTree.push(el)\r\n          }\r\n        })\r\n\r\n        this.orgTree.forEach(el => {\r\n          el.click_type = 1; //cây chính cho click luôn\r\n          el.main_tree = 1; //là cây chính\r\n\r\n          // ghép nhân sự vào gốc cây\r\n          // chỉ ghép những nhân sự của các chức danh\r\n          if (this.staffs && el.id !== this.organizationId) {\r\n            // ghép nhân sự vào theo id tổ chức\r\n            el.subs = this.staffs.filter(x => x.organization_id === el.id);\r\n          }\r\n\r\n        });\r\n        // console.log(this.orgTree);\r\n\r\n        //tạo cây tổ chức để hiển thị lên form\r\n        this.organizationsTree = this.apiCommon.createTreeMenu(this.orgTree, 'id', 'parent_id');\r\n        // console.log(this.organizationsTree);\r\n\r\n        //ghép thêm nhân sự Giám đốc, Phó Giám đốc vào gốc cây\r\n        this.organizationsTree.forEach(el => {\r\n          //lọc các nhân sự giám đốc, phó giám đốc của tổ chức\r\n          if (this.staffs && el.id + '' === '' + this.organizationId) {\r\n            let rootSubs = this.staffs.filter(x => x.organization_id === el.id);\r\n            //trường hợp refresh thì không cần thêm vào\r\n            if (!el.subs) el.subs = rootSubs;\r\n\r\n            //duyệt rootSubs nếu tìm thấy một đối tượng trong el.subs thì thôi thoát ra \r\n            //nếu không tìm thấy thì push vào\r\n            rootSubs.forEach(elsub => {\r\n              let index = el.subs.findIndex(x => x.id === elsub.id && x.organization_id === elsub.organization_id);\r\n              if (index >= 0) {\r\n                //không cần thêm vào nếu là lá cây\r\n                //trường hợp nó có subs thì phải thay thế nó\r\n                //if (elsub.subs) \r\n                el.subs.splice(index, 1, elsub); //thay thế lại\r\n              } else {\r\n                el.subs.unshift(elsub); //bổ sung vào đầu\r\n              }\r\n            })\r\n          }\r\n        })\r\n\r\n      }\r\n    } catch (e) {\r\n      console.log('Err:', e);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Click vào nội dung cấp Công ty/Trung tâm\r\n   * @param ev \r\n   * @param card \r\n   */\r\n  onClickSpec(ev, item) {\r\n    //console.log(item);\r\n    let menu = [\r\n      {\r\n        icon: {\r\n          name: \"md-add\",\r\n          color: \"secondary\",\r\n        },\r\n        name: \"Thêm nhân sự GĐ\",\r\n        value: \"add-child\"\r\n      }\r\n    ];\r\n\r\n    //Thực hiện hiển thị menu\r\n    this.apiCommon.presentPopover(\r\n      ev, PopoverCardComponent\r\n      , {\r\n        type: 'single-choice',\r\n        title: \"Chọn chức năng\",\r\n        color: \"primary\",\r\n        menu: menu\r\n      })\r\n      .then(data => {\r\n        // console.log(data);\r\n        this.processDetails(data, item)\r\n      })\r\n      .catch(err => {\r\n        console.log('err: ', err);\r\n      });\r\n\r\n  }\r\n\r\n  /**\r\n   * Click vào đơn vị cấp con\r\n   * @param event \r\n   */\r\n  onClickTreeItem(event) {\r\n\r\n    //Khai báo menu popup\r\n    let menu;\r\n\r\n    if (!event.item.main_tree) {\r\n      menu = [\r\n        {\r\n          icon: {\r\n            name: \"md-create\",\r\n            color: \"primary\",\r\n          },\r\n          name: \"Chỉnh sửa nhân sự\",\r\n          value: \"edit-owner\"\r\n        }\r\n        ,\r\n        {\r\n          icon: {\r\n            name: \"trash\",\r\n            color: \"danger\",\r\n          },\r\n          name: event.item.status === 1 ? \"Khóa bỏ nhân sự\" : \"Kích hoạt nhân sự\",\r\n          value: \"stop-owner\"\r\n        }\r\n      ];\r\n    } else {\r\n      menu = [\r\n        {\r\n          icon: {\r\n            name: \"md-add\",\r\n            color: \"secondary\",\r\n          },\r\n          name: \"Thêm nhân sự\",\r\n          value: \"add-child\"\r\n        }\r\n      ];\r\n    }\r\n\r\n    //Thực hiện hiển thị menu\r\n    this.apiCommon.presentPopover(\r\n      event.event, PopoverCardComponent\r\n      , {\r\n        type: 'single-choice',\r\n        title: \"Chọn chức năng\",\r\n        color: \"primary\",\r\n        menu: menu\r\n      })\r\n      .then(data => {\r\n        // console.log(data);\r\n        this.processDetails(data, event.item)\r\n      })\r\n      .catch(err => {\r\n        console.log('err: ', err);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Xử lý từng lệnh \r\n   * @param cmd \r\n   * @param item \r\n   */\r\n  processDetails(cmd, item) {\r\n\r\n    //thêm tham số\r\n    if (cmd.value === 'add-child') {\r\n      let itemNew = {\r\n        id: -1, //Giả id để thêm vào\r\n        organization_id: item.id,\r\n        table_name: 'staffs', //tên bảng cần đưa vào\r\n        wheres: [], //Mệnh đề wheres để update\r\n        title_name: item.name //tên của cấp cha\r\n      }\r\n\r\n      this.addNewItem(itemNew, 'add');\r\n    }\r\n\r\n    //sửa tham số\r\n    if (cmd.value === 'edit-owner') {\r\n      item.table_name = 'staffs';         //tên bảng cần đưa vào\r\n      item.wheres = ['id'];              //Mệnh đề wheres để update\r\n      item.title_name = item.organization_name;\r\n\r\n      this.addNewItem(item, 'edit');\r\n    }\r\n\r\n\r\n    //thay đổi trạng thái\r\n    if (cmd.value === 'stop-owner') {\r\n\r\n      item.table_name = 'staffs'; //tên bảng cần đưa vào\r\n      item.wheres = ['id'];      //Mệnh đề wheres để update\r\n\r\n      this.stopItem(item);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n     *Thêm hoặc sửa nhân sự\r\n     * @param item \r\n     */\r\n  addNewItem(item, type) {\r\n\r\n    // console.log('item', item);\r\n\r\n    let orgOptions = [];\r\n    //lấy tùy chọn đơn vị\r\n    if (Array.isArray(this.organizations)) {\r\n      this.organizations.forEach(el => {\r\n        orgOptions.push(\r\n          { name: el.name, value: parseInt(el.id) }\r\n        )\r\n      });\r\n    }\r\n\r\n    //tùy chọn chức danh\r\n    let jobOptions = [];\r\n    //tùy chọn chức danh kiêm nhiệm (bỏ chức danh chính đi)\r\n    let jobListOptions = [];\r\n\r\n    if (Array.isArray(this.jobRoles)) {\r\n      this.jobRoles.forEach(el => {\r\n        //chỉ lọc các chức danh trong tổ chức đó thôi\r\n        if (el.organization_id === item.organization_id) {\r\n\r\n          //lấy tùy chọn chức danh\r\n          jobOptions.push({ name: el.name, value: parseInt(el.id) })\r\n\r\n          //lấy danh sách tùy chọn chức danh kiêm nhiệm - bỏ chức danh đang đảm nhiệm\r\n          if (el.id !== item.job_id) {\r\n            jobListOptions.push({ name: el.name, value: parseInt(el.id) })\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Lấy danh sách chức danh kiêm nhiệm đã có\r\n    let list_str = []\r\n    if (item.job_list) {\r\n      item.job_list.forEach(el => {\r\n        list_str.push(\"\" + el)\r\n      });\r\n    }\r\n\r\n    let form = {\r\n      title: (type === 'add' ? 'THÊM' : 'SỬA') + \" DANH MỤC\"\r\n      , buttons: [\r\n        { color: \"danger\", icon: \"close\", next: \"CLOSE\" }\r\n      ]\r\n      , items: [\r\n        { type: \"title\", name: item.title_name }\r\n        , { type: \"hidden\", key: \"id\", value: item.id }\r\n        , { type: \"hidden\", key: \"organization_id\", value: item.organization_id }\r\n        , { type: \"hidden\", key: \"table_name\", value: item.table_name }\r\n        , { type: \"hidden\", key: \"wheres\", value: item.wheres }\r\n\r\n        //Nhập các thông tin của nhân sự\r\n        , { type: \"text\", key: \"name\", value: item.name, name: \"Họ và tên\", input_type: \"text\", icon: \"contact\", validators: [{ required: true, min: 3, max: 100 }], hint: \"Độ dài tên cho phép từ 3 đến 100 ký tự\" }\r\n        , { type: \"select-origin\", key: \"organization_id\", name: \"Thuộc đơn vị\", value: \"\" + item.organization_id, options: orgOptions, icon: \"logo-windows\", validators: [{ required: true }], hint: \"Chọn một đơn vị trực thuộc\" }\r\n        , { type: \"select-origin\", key: \"job_id\", name: \"Chức danh\", value: item.job_id ? \"\" + item.job_id : undefined, options: jobOptions, icon: \"logo-wordpress\", validators: [{ required: true }], hint: \"Chọn một chức danh\" }\r\n        , { type: \"select-multiple-origin\", key: \"job_list\", name: \"Chức danh kiêm nhiệm\", value: list_str, options: jobListOptions, icon: \"logo-buffer\", hint: \"Chọn các công việc kiêm nhiệm của cá nhân đó\" }\r\n        , {\r\n          type: \"button\"\r\n          , options: [\r\n            { name: \"Reset\", next: \"RESET\" }\r\n            , {\r\n              name: type === 'add' ? 'Tạo mới' : 'Chỉnh sửa', next: \"CALLBACK\"\r\n              , url: this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + \"/post-parameters\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n\r\n    this.apiCommon.openModal(DynamicFormMobilePage, {\r\n      parent: this,\r\n      form: form,\r\n      callback: this.callbackProcess\r\n    })\r\n\r\n  }\r\n\r\n  /**\r\n   * Dừng đối tượng này\r\n   * @param item \r\n   */\r\n  stopItem(item) {\r\n    let form = {\r\n      title: \"Thay đổi trạng thái\"\r\n      , home_disable: true\r\n      , buttons: [\r\n        { color: \"danger\", icon: \"close\", next: \"CLOSE\" }\r\n      ]\r\n      , items: [\r\n        { type: \"title\", name: item.name }\r\n        , { type: \"hidden\", key: \"id\", value: item.id } //đối tượng để update\r\n        , { type: \"hidden\", key: \"table_name\", value: item.table_name }\r\n        , { type: \"hidden\", key: \"wheres\", value: item.wheres }\r\n        , { type: \"datetime\", key: \"changed_date\", value: item.changed_date, name: \"Chọn ngày thay đổi trạng thái\", display: \"DD/MM/YYYY\", picker: \"DD/MM/YYYY\" }\r\n        , { type: \"toggle\", key: \"status\", name: item.status ? \"Tạm ngưng?\" : \"Kích hoạt?\", value: item.status, color: \"secondary\", icon: \"hand\" }\r\n        , {\r\n          type: \"button\"\r\n          , options: [\r\n            {\r\n              name: 'Cập nhập', next: \"CALLBACK\", url: this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + \"/post-parameters\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n\r\n    this.apiCommon.openModal(DynamicFormMobilePage, {\r\n      parent: this,\r\n      form: form,\r\n      callback: this.callbackProcess\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Hàm xử lý kết quả post sửa thêm\r\n   */\r\n  callbackProcess = function (res) {\r\n\r\n    //console.log(res);\r\n\r\n    return new Promise(resolve => {\r\n\r\n      if (res.error) {\r\n        this.apiCommon.presentAlert('Lỗi:<br>' + (res.error && res.error.message ? res.error.message : \"Error Unknow: \" + JSON.stringify(res.error)));\r\n      } else if (res.ajax) {\r\n        //res.ajax.key==='organization_id' là trường có giá trị thay đổi\r\n        //res.ajax.value là giá trị thay đổi ở trường có tên ở trên\r\n        if (res.ajax.key === 'organization_id' && res.ajax.value) {\r\n\r\n          //tùy chọn chức danh\r\n          let jobOptions = [];\r\n\r\n          //tùy chọn chức danh kiêm nhiệm (bỏ chức danh chính đi)\r\n          let jobListOptions = [];\r\n\r\n          //lấy danh sách chức danh tùy chọn\r\n          if (Array.isArray(this.jobRoles)) {\r\n            this.jobRoles.forEach(el => {\r\n              //chỉ lọc chức danh của tổ chức được chọn thôi\r\n              if (el.organization_id == res.ajax.value) {//chỉ so sánh giá trị thôi (không so sánh kiểu)\r\n\r\n                //lấy tùy chọn chức danh\r\n                jobOptions.push({ name: el.name, value: parseInt(el.id) })\r\n\r\n                //vì không biết chọn chức danh nào nên vẫn trả đủ danh sách chức danh kiêm nhiệm\r\n                jobListOptions.push({ name: el.name, value: parseInt(el.id) })\r\n              }\r\n\r\n            });\r\n          }\r\n\r\n          //báo cho form động biết cần thay đổi trường dữ liệu ajax nào\r\n          resolve([\r\n            {\r\n              key: \"job_id\" //tìm item có key là trường này\r\n              , property_name: \"options\"   //nếu tìm thấy thì thay thuộc tính có tên ở đây\r\n              , new_data: jobOptions //bằng giá trị mới cập nhập do chọn lựa từ form này\r\n            }\r\n            ,\r\n            {\r\n              key: \"job_list\" //tìm item có key là trường này\r\n              , property_name: \"options\"   //nếu tìm thấy thì thay thuộc tính có tên ở đây\r\n              , new_data: jobListOptions //bằng giá trị mới cập nhập do chọn lựa từ form này\r\n            }\r\n          ])\r\n\r\n        } else if (res.ajax.key === 'job_id' && res.ajax.value) {\r\n          //vì thay đổi chức danh chính nên\r\n          //thay đổi chức danh kiêm nhiệm là trừ công việc chính đi\r\n          let jobListOptions = [];\r\n\r\n          if (Array.isArray(this.jobRoles)) {\r\n\r\n            //lấy công việc chính đã chọn\r\n            let elSelected = this.jobRoles.find(x => x.id == res.ajax.value);\r\n\r\n            if (elSelected) {\r\n              this.jobRoles.forEach(el => {\r\n                //chỉ lọc chức danh của tổ chức được chọn thôi\r\n                //loại trừ chức danh được chọn\r\n                if (el.organization_id === elSelected.organization_id && el.id != res.ajax.value) {\r\n                  jobListOptions.push({ name: el.name, value: parseInt(el.id) })\r\n                }\r\n              });\r\n            }\r\n\r\n            //báo cho form động biết cần thay đổi trường dữ liệu ajax nào\r\n            // console.log(jobListOptions);\r\n            resolve(\r\n              {\r\n                key: \"job_list\" //tìm item có key là trường này\r\n                , property_name: \"options\"   //nếu tìm thấy thì thay thuộc tính có tên ở đây\r\n                , new_data: jobListOptions //bằng giá trị mới cập nhập do chọn lựa từ form này\r\n              }\r\n            )\r\n\r\n          }\r\n\r\n        }\r\n\r\n        return; //nếu gọi kiểu ajax thì chỉ trả về cho form đó thôi, không đóng form popup\r\n\r\n      } else {\r\n        //Báo cho socket biết là thực hiện xong\r\n        this.socket.emit('client-staff-done');\r\n      }\r\n      resolve({ next: \"CLOSE\" })\r\n    })\r\n  }.bind(this)\r\n\r\n  async onClickDownload() {\r\n    let templateFile = this.apiAuth.serviceUrls.RESOURCE_SERVER + '/get-templates/sample-danhmuc-tochuc.xlsx'\r\n    let blobData = await this.apiAuth.getDynamicUrl(templateFile, '', { responseType: 'blob' });\r\n    let fr = new FileReader();\r\n    fr.readAsArrayBuffer(blobData);\r\n    fr.onloadend = async () => {\r\n      let bufferData: any = fr.result;\r\n      let wb = new Excel.Workbook();\r\n      let workbook = await wb.xlsx.load(bufferData);\r\n      //ẩn các sheet không mong muốn\r\n      workbook.eachSheet(sheet => {\r\n        if (sheet.name != config.sheet_name.value) sheet.state = 'hidden';\r\n      })\r\n      let worksheet = workbook.getWorksheet(config.sheet_name.value);\r\n\r\n      let row = worksheet.getRow(2);\r\n      row.getCell(\"A\").value = this.organizationsTree[0].name;\r\n      row.getCell(\"G\").value = this.organizationsTree[0].id;\r\n\r\n      // xác định bề rộng cho các cột\r\n      worksheet.getColumn(1).width = 5\r\n      worksheet.getColumn(2).width = 25\r\n      worksheet.getColumn(4).width = 25\r\n      worksheet.getColumn(6).width = 30\r\n      worksheet.getColumn(8).width = 20\r\n      worksheet.getColumn(9).width = 25\r\n\r\n      // tự động xuống hàng nếu text quá dài\r\n      worksheet.getColumn(2).alignment = { wrapText: true };\r\n      worksheet.getColumn(4).alignment = { wrapText: true };\r\n      worksheet.getColumn(6).alignment = { wrapText: true };\r\n      worksheet.getColumn(8).alignment = { wrapText: true };\r\n      worksheet.getColumn(9).alignment = { wrapText: true };\r\n\r\n      let idx = 4;\r\n      // Lặp mảng để ghi dữ liệu vào excel\r\n      this.staffs.forEach(el => {\r\n        row = worksheet.getRow(idx);\r\n        row.getCell(config.noId.value).value = idx - 3;\r\n        row.getCell(config.name.value).value = el.name;\r\n        row.getCell(config.organization_id.value).value = el.organization_id;\r\n        row.getCell(config.organization_name.value).value = el.organization_name;\r\n        row.getCell(config.job_id.value).value = el.job_id;\r\n        row.getCell(config.job_name.value).value = el.job_name;\r\n        row.getCell(config.id.value).value = el.id;\r\n        row.getCell(config.job_list.value).value = el.job_list;\r\n        row.getCell(config.job_list_name.value).value = el.job_list_name;\r\n        idx++;\r\n      });\r\n\r\n      workbook.views = [\r\n        {\r\n          x: 0, y: 0, width: 10000, height: 20000,\r\n          firstSheet: 2, activeTab: 2, visibility: 'visible'\r\n        }\r\n      ];\r\n\r\n      //Ghi file excel\r\n      workbook.xlsx.writeBuffer().then((data) => {\r\n        let blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\r\n        fs.saveAs(blob, `excel-staffs-${Date.now()}.xlsx`);\r\n      })\r\n    }\r\n  }\r\n\r\n  onClickUpload(ev) {\r\n    let arFile = ev.target.files;\r\n    // console.log(arFile);\r\n    let fr = new FileReader();\r\n    fr.readAsArrayBuffer(arFile[0]);\r\n    fr.onloadend = async () => {\r\n      let bufferData: any = fr.result;\r\n      let wb = new Excel.Workbook();\r\n      try {\r\n        let workbook = await wb.xlsx.load(bufferData)\r\n        let worksheet = workbook.getWorksheet(config.sheet_name.value);\r\n        let results = []\r\n        worksheet.eachRow((row, rowIndex) => {\r\n          if (rowIndex > 3) {\r\n            let cols = {}\r\n            for (let key in config) {\r\n              let item = config[key];\r\n              if (key != \"sheet_name\") {\r\n                Object.defineProperty(cols\r\n                  , key\r\n                  , { value: this.getValueFormula(row.values[this.convertColExcel2Number(item.value)]) })\r\n              }\r\n            }\r\n            results.push(cols);\r\n          }\r\n        })\r\n        // console.log(results);\r\n        let returnFinish = { count_success: 0, count_fail: 0 };\r\n        // hàm này để kiểm tra organization_id post lên có nằm trong danh sách organization_id của user không?\r\n        let checkId = (id, arr) => {\r\n          for (let el of arr) {\r\n            if (id === el.id) return true;\r\n          }\r\n          return false;\r\n        }\r\n        for (const el of results) {\r\n          if (checkId(el.organization_id, this.orgTree)) {\r\n            let jsonPost = {\r\n              id: el.id,\r\n              organization_id: el.organization_id,\r\n              name: el.name,\r\n              job_id: el.job_id,\r\n              job_list: el.job_list,\r\n            }\r\n            // console.log(jsonPost);\r\n            try {\r\n              await this.apiAuth.postDynamicJson(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + '/post-staffs', jsonPost)\r\n              returnFinish.count_success++;\r\n            } catch (err) {\r\n              // console.log(err);\r\n              returnFinish.count_fail++;\r\n            }\r\n          }\r\n        }\r\n        console.log(returnFinish);\r\n        //Báo cho socket biết là thực hiện xong\r\n        this.socket.emit('client-staff-done');\r\n\r\n      } catch (err) {\r\n        console.log('Lỗi đọc file excel nguồn!', err);\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  convertColExcel2Number = (val: string): number => {\r\n    var base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', i, j, result = 0;\r\n    for (i = 0, j = val.length - 1; i < val.length; i += 1, j -= 1) {\r\n      result += Math.pow(base.length, j) * (base.indexOf(val[i]) + 1);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  getValueFormula(obj) {\r\n    if (obj === null || obj === undefined) return null\r\n    if (typeof obj === 'object') {\r\n      // xử lý chuyển đổi chỉ lấy text thôi\r\n      if (obj.richText) return obj.richText.map(o => o[\"text\"]).join(\"\")\r\n      // lấy giá trị bằng biểu thức function\r\n      return obj.result\r\n    }\r\n    return obj\r\n  }\r\n\r\n}"]}