{"version":3,"sources":["webpack:///src/app/pages/organizations/organizations.page.html","webpack:///src/app/pages/organizations/organizations.module.ts","webpack:///src/app/pages/organizations/organizations.page.scss","webpack:///src/app/pages/organizations/organizations.page.ts","webpack:///src/app/services/api-download.service.ts","webpack:///src/app/services/api-excel.service.ts"],"names":["OrganizationsPageModule","imports","forChild","path","component","declarations","config","sheet_name","value","noId","name","short_name","description","id","parent_id","OrganizationsPage","apiAuth","apiCommon","apiDownload","apiExcel","socket","callbackProcess","res","Promise","resolve","error","presentAlert","message","JSON","stringify","emit","next","callbackDownload","ws","writeExcel","processWriteExcel","organizationsTree","status","count","bind","convertColExcel2Number","val","base","i","j","result","length","Math","pow","indexOf","refreshNews","on","getDynamicUrl","serviceUrls","RESOURCE_SERVER","userReport","organizations","Array","isArray","createTreeMenu","filter","x","organization_id","ev","item","menu","icon","color","presentPopover","type","title","then","data","processDetails","err","console","log","event","cmd","itemNew","table_name","wheres","title_name","updateItem","stopItem","form","buttons","items","key","input_type","validators","required","min","max","hint","options","url","openModal","parent","callback","changed_date","display","picker","linkFile","processFileDownload","arFile","target","files","fr","FileReader","readAsArrayBuffer","onloadend","bufferData","wb","xlsx","load","workbook","worksheet","getWorksheet","results","eachRow","row","rowIndex","cols","Object","defineProperty","getValueFormula","values","push","returnFinish","count_success","count_fail","el","jsonPost","postDynamicJson","obj","undefined","richText","map","o","join","selector","template","ApiDownloadService","urlTemplateFile","file_name","callbackPromise","responseType","blobData","arrayOutput","eachSheet","sheet","resultCallback","splice","state","views","y","width","height","firstSheet","activeTab","visibility","writeBuffer","blob","Blob","Date","now","providedIn","ApiExcelService","getRow","getCell","getColumn","alignment","wrapText","index","subs","forEach"],"mappings":"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","file":"pages-organizations-organizations-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n      <ion-back-button></ion-back-button>\\r\\n      <ion-button>\\r\\n        <input class=\\\"file-over\\\" type=\\\"file\\\" (change)=\\\"onClickUpload($event)\\\"\\r\\n          accept=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\\\" />\\r\\n        <ion-icon name=\\\"cloud-upload\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-title>MÔ HÌNH TỔ CHỨC</ion-title>\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-button (click)=\\\"onClickDownload()\\\">\\r\\n        <ion-icon name=\\\"cloud-download\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-row>\\r\\n    <ion-col size=\\\"12\\\" class=\\\"card-prospect\\\" *ngFor=\\\"let item of organizationsTree\\\"\\r\\n      [style.background]=\\\"'#fafafaf6'\\\">\\r\\n      <ion-row (click)=\\\"onClickSpec($event, item)\\\">\\r\\n        <ion-col size=\\\"10\\\" class=\\\"prospect-header\\\" [style.color]=\\\"'darkblue'\\\">\\r\\n          <ion-icon *ngIf=\\\"item.click_type\\\" style=\\\"font-size: 1em\\\" [style.color]=\\\"'lightblue'\\\" name=\\\"md-cloud-upload\\\">\\r\\n          </ion-icon>{{item.name}}\\r\\n        </ion-col>\\r\\n        <ion-col size=\\\"2\\\" class=\\\"prospect-header\\\" [style.color]=\\\"'darkblue'\\\">\\r\\n          {{item.id}}\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n\\r\\n      <tree-list [treeData]=\\\"item.subs\\\" (onClickKpi)=\\\"onClickTreeItem($event)\\\"></tree-list>\\r\\n\\r\\n    </ion-col>\\r\\n  </ion-row>\\r\\n</ion-content>\";","import { NgModule } from '@angular/core';\r\nimport { RouterModule } from '@angular/router';\r\n\r\nimport { OrganizationsPage } from './organizations.page';\r\nimport { SharedModule } from '../../shared.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    SharedModule,\r\n    RouterModule.forChild([\r\n      {\r\n        path: '',\r\n        component: OrganizationsPage\r\n      }\r\n    ])\r\n  ],\r\n  declarations: [OrganizationsPage]\r\n})\r\nexport class OrganizationsPageModule {}\r\n","export default \".card-title-header {\\n  font-size: 1.5em;\\n  width: 90%;\\n  font-weight: bold;\\n  color: darkblue;\\n  text-transform: uppercase;\\n  opacity: 0.7;\\n}\\n\\n.card-prospect {\\n  border-radius: 0.8em;\\n  border: solid 0.15em #FFFFFF;\\n  width: 100%;\\n}\\n\\n.card-prospect .prospect-header {\\n  font-size: 1.2em;\\n  width: 100%;\\n  font-weight: bold;\\n  text-transform: uppercase;\\n  opacity: 0.9;\\n}\\n\\n.table-row .table-header {\\n  background: #99b7f0e0 !important;\\n  color: #0a0909fb !important;\\n  font-weight: bold;\\n}\\n\\n.table-row ion-col {\\n  border: solid 0.1em #FFFFFF;\\n  font-size: 1.3em;\\n}\\n\\n.table-row ion-row:nth-of-type(odd) {\\n  background: #fafafaf6;\\n  color: #202020;\\n  opacity: 0.9;\\n}\\n\\n.table-row ion-row:nth-of-type(even) {\\n  background: #e6f5f8;\\n  color: #202020;\\n  opacity: 0.7;\\n}\\n\\n.file-over {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 2;\\n  width: 100%;\\n  height: 100%;\\n  opacity: 1;\\n  cursor: pointer;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvb3JnYW5pemF0aW9ucy9FOlxcTVlEQVRBXFxMQVBUUklOSFxcTk9ERTRcXG5vZGU0LXFsbnNcXGNsaWVudC9zcmNcXGFwcFxccGFnZXNcXG9yZ2FuaXphdGlvbnNcXG9yZ2FuaXphdGlvbnMucGFnZS5zY3NzIiwic3JjL2FwcC9wYWdlcy9vcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbnMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0VBQ0ksZ0JBQUE7RUFDQSxVQUFBO0VBQ0EsaUJBQUE7RUFDQSxlQUFBO0VBQ0EseUJBQUE7RUFDQSxZQUFBO0FDQUo7O0FESUE7RUFDSSxvQkFBQTtFQUNBLDRCQUFBO0VBQ0EsV0FBQTtBQ0RKOztBREtBO0VBQ0ksZ0JBQUE7RUFDQSxXQUFBO0VBQ0EsaUJBQUE7RUFDQSx5QkFBQTtFQUNBLFlBQUE7QUNGSjs7QURNQTtFQUNJLGdDQUFBO0VBQ0EsMkJBQUE7RUFDQSxpQkFBQTtBQ0hKOztBRE1BO0VBQ0ksMkJBQUE7RUFDQSxnQkFBQTtBQ0hKOztBRE1BO0VBQ0kscUJBQUE7RUFDQSxjQUFBO0VBQ0EsWUFBQTtBQ0hKOztBRE1BO0VBQ0ksbUJBQUE7RUFDQSxjQUFBO0VBQ0EsWUFBQTtBQ0hKOztBRE1BO0VBQ0ksa0JBQUE7RUFDQSxNQUFBO0VBQ0EsT0FBQTtFQUNBLFVBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtFQUNBLFVBQUE7RUFDQSxlQUFBO0FDSEoiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9vcmdhbml6YXRpb25zL29yZ2FuaXphdGlvbnMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLy90aGnhur90IGzhuq1wIGNo4buvIGNobyB0acOqdSDEkeG7gSBjw7RuZyB0eVxyXG4uY2FyZC10aXRsZS1oZWFkZXIge1xyXG4gICAgZm9udC1zaXplOiAxLjVlbTtcclxuICAgIHdpZHRoOiA5MCU7XHJcbiAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgIGNvbG9yOiBkYXJrYmx1ZTtcclxuICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XHJcbiAgICBvcGFjaXR5OiAwLjc7XHJcbn1cclxuXHJcbi8vVGhp4bq/dCBs4bqtcCBraHVuZyBu4buBbiB2w6AgY+G7oSBjaOG7ryBjaG8gY2FyZCB2aeG7hW4gY+G6o25oXHJcbi5jYXJkLXByb3NwZWN0e1xyXG4gICAgYm9yZGVyLXJhZGl1czogMC44ZW07XHJcbiAgICBib3JkZXI6IHNvbGlkIDAuMTVlbSAjRkZGRkZGO1xyXG4gICAgd2lkdGg6MTAwJTtcclxuICAgIC8vb3BhY2l0eTogMC44O1xyXG59XHJcblxyXG4uY2FyZC1wcm9zcGVjdCAucHJvc3BlY3QtaGVhZGVyIHtcclxuICAgIGZvbnQtc2l6ZTogMS4yZW07XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcclxuICAgIG9wYWNpdHk6IDAuOTtcclxufVxyXG5cclxuLy9UaGnhur90IGzhuq1wIGTDsm5nIGNo4bq1biBs4bq7IGNobyBi4bqjbmdcclxuLnRhYmxlLXJvdyAudGFibGUtaGVhZGVyIHsgLy904bqldCBj4bqjIGPDoWMgY+G7mXQgc2F1IGNsYXNzIG7DoHlcclxuICAgIGJhY2tncm91bmQ6ICM5OWI3ZjBlMCAhaW1wb3J0YW50O1xyXG4gICAgY29sb3I6IzBhMDkwOWZiICFpbXBvcnRhbnQ7XHJcbiAgICBmb250LXdlaWdodDogYm9sZDtcclxufVxyXG5cclxuLnRhYmxlLXJvdyBpb24tY29sIHsgLy904bqldCBj4bqjIGPDoWMgY+G7mXQgc2F1IGNsYXNzIG7DoHlcclxuICAgIGJvcmRlcjogc29saWQgMC4xZW0gI0ZGRkZGRjtcclxuICAgIGZvbnQtc2l6ZTogMS4zZW07XHJcbn1cclxuXHJcbi50YWJsZS1yb3cgaW9uLXJvdzpudGgtb2YtdHlwZShvZGQpIHsgLy9kw7JuZyBs4bq7XHJcbiAgICBiYWNrZ3JvdW5kOiAjZmFmYWZhZjY7XHJcbiAgICBjb2xvcjojMjAyMDIwO1xyXG4gICAgb3BhY2l0eTogMC45O1xyXG59XHJcblxyXG4udGFibGUtcm93IGlvbi1yb3c6bnRoLW9mLXR5cGUoZXZlbikgeyAvL2TDsm5nIGNo4bq1blxyXG4gICAgYmFja2dyb3VuZDogI2U2ZjVmODtcclxuICAgIGNvbG9yOiMyMDIwMjA7XHJcbiAgICBvcGFjaXR5OiAwLjc7XHJcbn1cclxuXHJcbi5maWxlLW92ZXIge1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgdG9wOiAwO1xyXG4gICAgbGVmdDogMDtcclxuICAgIHotaW5kZXg6IDI7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGhlaWdodDogMTAwJTtcclxuICAgIG9wYWNpdHk6IDE7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbn0iLCIuY2FyZC10aXRsZS1oZWFkZXIge1xuICBmb250LXNpemU6IDEuNWVtO1xuICB3aWR0aDogOTAlO1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgY29sb3I6IGRhcmtibHVlO1xuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuICBvcGFjaXR5OiAwLjc7XG59XG5cbi5jYXJkLXByb3NwZWN0IHtcbiAgYm9yZGVyLXJhZGl1czogMC44ZW07XG4gIGJvcmRlcjogc29saWQgMC4xNWVtICNGRkZGRkY7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4uY2FyZC1wcm9zcGVjdCAucHJvc3BlY3QtaGVhZGVyIHtcbiAgZm9udC1zaXplOiAxLjJlbTtcbiAgd2lkdGg6IDEwMCU7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xuICBvcGFjaXR5OiAwLjk7XG59XG5cbi50YWJsZS1yb3cgLnRhYmxlLWhlYWRlciB7XG4gIGJhY2tncm91bmQ6ICM5OWI3ZjBlMCAhaW1wb3J0YW50O1xuICBjb2xvcjogIzBhMDkwOWZiICFpbXBvcnRhbnQ7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufVxuXG4udGFibGUtcm93IGlvbi1jb2wge1xuICBib3JkZXI6IHNvbGlkIDAuMWVtICNGRkZGRkY7XG4gIGZvbnQtc2l6ZTogMS4zZW07XG59XG5cbi50YWJsZS1yb3cgaW9uLXJvdzpudGgtb2YtdHlwZShvZGQpIHtcbiAgYmFja2dyb3VuZDogI2ZhZmFmYWY2O1xuICBjb2xvcjogIzIwMjAyMDtcbiAgb3BhY2l0eTogMC45O1xufVxuXG4udGFibGUtcm93IGlvbi1yb3c6bnRoLW9mLXR5cGUoZXZlbikge1xuICBiYWNrZ3JvdW5kOiAjZTZmNWY4O1xuICBjb2xvcjogIzIwMjAyMDtcbiAgb3BhY2l0eTogMC43O1xufVxuXG4uZmlsZS1vdmVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHotaW5kZXg6IDI7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIG9wYWNpdHk6IDE7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn0iXX0= */\";","import { Component } from '@angular/core';\r\nimport { AuthService, CommonsService, PopoverCardComponent, DynamicFormMobilePage } from 'ngxi4-dynamic-service';\r\nimport { ApiDownloadService } from 'src/app/services/api-download.service';\r\nimport { ApiExcelService } from 'src/app/services/api-excel.service';\r\nimport { Socket } from 'ngx-socket-io';\r\n\r\nimport * as Excel from \"exceljs\";\r\n\r\nconst config = {\r\n  sheet_name: { value: \"organizations\" }\r\n  , noId: { value: \"A\" }\r\n  , name: { value: \"B\" }\r\n  , short_name: { value: \"C\" }\r\n  , description: { value: \"D\" }\r\n  , id: { value: \"E\" }\r\n  , parent_id: { value: \"F\" }\r\n}\r\n\r\n@Component({\r\n  selector: 'app-organizations',\r\n  templateUrl: 'organizations.page.html',\r\n  styleUrls: ['organizations.page.scss'],\r\n})\r\nexport class OrganizationsPage {\r\n\r\n  userReport: any;\r\n\r\n  organizations: any; //danh sách tổ chức từ csdl\r\n  organizationsTree: any; //cây tổ chức để hiển thị\r\n\r\n  constructor(\r\n    private apiAuth: AuthService\r\n    , private apiCommon: CommonsService\r\n    , private apiDownload: ApiDownloadService\r\n    , private apiExcel: ApiExcelService\r\n    , private socket: Socket\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.refreshNews();\r\n    this.socket.on(\"Server-send-data\", () => {\r\n      this.refreshNews();\r\n    });\r\n  }\r\n\r\n  async refreshNews() {\r\n\r\n    try {\r\n      // lấy mã tổ chức của username: 0766777123\r\n      this.userReport = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-user-report\");\r\n      // console.log(this.userReport);\r\n\r\n      // Lấy danh sách tổ chức\r\n      this.organizations = await this.apiAuth.getDynamicUrl(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n        + \"/get-organizations\");\r\n      // console.log(this.organizations);\r\n      if (Array.isArray(this.organizations)) {\r\n\r\n        // Dùng service để chuyển thành cây tổ chức\r\n        let organizationsTree = this.apiCommon.createTreeMenu(this.organizations, 'id', 'parent_id');\r\n        // console.log(organizationsTree);\r\n\r\n        // Lấy cây tổ chức theo userReport.organization_id\r\n        if (this.userReport && Array.isArray(organizationsTree)) {\r\n          this.organizationsTree = organizationsTree.filter(x => x.id === this.userReport.organization_id);\r\n        } else {\r\n          this.organizationsTree = organizationsTree;\r\n        }\r\n        // console.log(this.organizationsTree);\r\n\r\n      }\r\n\r\n    } catch (e) { }\r\n  }\r\n\r\n  /**\r\n   * Click vào nội dung cấp Công ty/Trung tâm\r\n   * @param ev \r\n   * @param card \r\n   */\r\n  onClickSpec(ev, item) {\r\n    let menu =\r\n      [\r\n        {\r\n          name: \"Thêm đơn vị phụ thuộc\",\r\n          value: \"add-child\",\r\n          icon: {\r\n            name: \"md-add\",\r\n            color: \"secondary\",\r\n          }\r\n        }\r\n        ,\r\n        {\r\n          name: \"Chỉnh sửa thông tin\",\r\n          value: \"edit-owner\",\r\n          icon: {\r\n            name: \"md-create\",\r\n            color: \"primary\",\r\n          }\r\n        }\r\n      ];\r\n\r\n    //Thực hiện hiển thị menu\r\n    this.apiCommon.presentPopover(\r\n      ev, PopoverCardComponent\r\n      , {\r\n        type: 'single-choice',\r\n        title: \"Chọn chức năng\",\r\n        color: \"primary\",\r\n        menu: menu\r\n      })\r\n      .then(data => {\r\n        // console.log(data);\r\n        this.processDetails(data, item)\r\n      })\r\n      .catch(err => {\r\n        console.log('err: ', err);\r\n      });\r\n\r\n  }\r\n\r\n  /**\r\n   * Kích vào nội dung cấp con (tổ chức)\r\n   * @param event \r\n   */\r\n  onClickTreeItem(event) {\r\n    // console.log(event);\r\n\r\n    //Khai báo menu popup\r\n    let menu = [\r\n      {\r\n        name: \"Chỉnh sửa thông tin\",\r\n        value: \"edit-owner\",\r\n        icon: {\r\n          name: \"md-create\",\r\n          color: \"primary\",\r\n        }\r\n      }\r\n      ,\r\n      {\r\n        name: event.item.status === 1 ? \"Loại bỏ đơn vị\" : \"Kích hoạt đơn vị\",\r\n        value: \"stop-owner\",\r\n        icon: {\r\n          name: \"trash\",\r\n          color: \"danger\",\r\n        }\r\n      }\r\n    ];\r\n\r\n    //Thực hiện hiển thị menu\r\n    this.apiCommon.presentPopover(\r\n      event.event, PopoverCardComponent\r\n      , {\r\n        type: 'single-choice',\r\n        title: \"Chọn chức năng\",\r\n        color: \"primary\",\r\n        menu: menu\r\n      })\r\n      .then(data => {\r\n        // console.log(data);\r\n        this.processDetails(data, event.item);\r\n      })\r\n      .catch(err => {\r\n        console.log('err: ', err);\r\n      });\r\n\r\n  }\r\n\r\n  /**\r\n   * Xử lý từng lệnh \r\n   * @param cmd \r\n   * @param item \r\n   */\r\n  processDetails(cmd, item) {\r\n\r\n    //thêm tham số\r\n    if (cmd.value === 'add-child') {\r\n\r\n      let itemNew = {\r\n        id: -1, //Giả id để thêm vào\r\n        parent_id: item.id, //kế thừa cấp cha của nó\r\n        table_name: 'organizations', //tên bảng cần đưa vào\r\n        wheres: [], //Mệnh đề wheres để update\r\n        title_name: item.name //tên của cấp cha\r\n      }\r\n\r\n      this.updateItem(itemNew, 'add');\r\n    }\r\n\r\n    //sửa tham số\r\n    if (cmd.value === 'edit-owner') {\r\n\r\n      item.table_name = 'organizations'; //tên bảng cần đưa vào\r\n      item.wheres = ['id'];              //Mệnh đề wheres để update = '';\r\n      item.title_name = item.name;\r\n\r\n      this.updateItem(item, 'edit');\r\n    }\r\n\r\n    //tạm dừng tham số\r\n    if (cmd.value === 'stop-owner') {\r\n\r\n      item.table_name = 'organizations'; //tên bảng cần đưa vào\r\n      item.wheres = ['id'];              //Mệnh đề wheres để update = '';\r\n\r\n      this.stopItem(item);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Thêm hoặc sửa tham số\r\n   * @param item \r\n   */\r\n  updateItem(item, type) {\r\n\r\n    let form = {\r\n      title: (type === 'add' ? 'THÊM' : 'SỬA') + \" DANH MỤC\"\r\n      , buttons: [\r\n        { color: \"danger\", icon: \"close\", next: \"CLOSE\" }\r\n      ]\r\n      , items: [\r\n        { type: \"title\", name: item.title_name }\r\n        , { type: \"hidden\", key: \"id\", value: item.id }\r\n        , { type: \"hidden\", key: \"parent_id\", value: item.parent_id }\r\n        , { type: \"hidden\", key: \"table_name\", value: item.table_name }\r\n        , { type: \"hidden\", key: \"wheres\", value: item.wheres }\r\n\r\n        , { type: \"text\", key: \"name\", value: item.name, name: \"Tên đơn vị\", input_type: \"text\", icon: \"logo-buffer\", validators: [{ required: true, min: 5, max: 100 }], hint: \"Độ dài tên cho phép từ 5 đến 100 ký tự\" }\r\n        , { type: \"text\", key: \"short_name\", value: item.short_name, name: \"Tên viết tắt\", input_type: \"text\", icon: \"at\", validators: [{ required: true, min: 1, max: 6 }], hint: \"Độ dài tối đa 6 ký tự\" }\r\n        , { type: \"text_area\", key: \"description\", value: item.description, name: \"Mô tả thông tin của đơn vị\", input_type: \"text\", icon: \"md-alert\", hint: \"Nhập mô tả này để ghi nhớ\" }\r\n        , {\r\n          type: \"button\"\r\n          , options: [\r\n            { name: \"Reset\", next: \"RESET\" }\r\n            , {\r\n              name: type === 'add' ? 'Tạo mới' : 'Chỉnh sửa', next: \"CALLBACK\"\r\n              , url: this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + \"/post-parameters\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n\r\n    this.apiCommon.openModal(DynamicFormMobilePage, {\r\n      parent: this,\r\n      form: form,\r\n      callback: this.callbackProcess\r\n    })\r\n\r\n  }\r\n\r\n  /**\r\n   * Hàm loại bỏ/kích hoạt đơn vị\r\n   * @param item \r\n   */\r\n  stopItem(item) {\r\n    let form = {\r\n      title: \"Thay đổi trạng thái\"\r\n      , buttons: [\r\n        { color: \"danger\", icon: \"close\", next: \"CLOSE\" }\r\n      ]\r\n      , items: [\r\n        { type: \"title\", name: item.name }\r\n        , { type: \"hidden\", key: \"id\", value: item.id }\r\n        , { type: \"hidden\", key: \"table_name\", value: item.table_name }\r\n        , { type: \"hidden\", key: \"wheres\", value: item.wheres }\r\n        , { type: \"datetime\", key: \"changed_date\", value: item.changed_date, name: \"Chọn ngày thay đổi trạng thái\", display: \"DD/MM/YYYY\", picker: \"DD/MM/YYYY\" }\r\n        , { type: \"toggle\", key: \"status\", name: item.status ? \"Tạm ngưng?\" : \"Kích hoạt?\", value: item.status, color: \"secondary\", icon: \"hand\" }\r\n        , {\r\n          type: \"button\"\r\n          , options: [\r\n            {\r\n              name: 'Cập nhập', next: \"CALLBACK\", url: this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + \"/post-parameters\"\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n\r\n    this.apiCommon.openModal(DynamicFormMobilePage, {\r\n      parent: this,\r\n      form: form,\r\n      callback: this.callbackProcess\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Hàm xử lý kết quả post thêm sửa xóa\r\n   */\r\n  callbackProcess = (res) => {\r\n\r\n    // console.log(res);\r\n\r\n    return new Promise(resolve => {\r\n\r\n      if (res.error) {\r\n        this.apiCommon.presentAlert('Lỗi:<br>' + (res.error && res.error.message ? res.error.message : \"Error Unknow: \" + JSON.stringify(res.error)))\r\n      } else {\r\n        //Báo cho socket biết là thực hiện xong\r\n        this.socket.emit('Client-send-data');\r\n      }\r\n      resolve({ next: \"CLOSE\" })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Download file excel xuống máy\r\n   */\r\n  onClickDownload() {\r\n    let linkFile = this.apiAuth.serviceUrls.RESOURCE_SERVER + '/get-templates/sample-danhmuc-tochuc.xlsx'\r\n    this.apiDownload.processFileDownload(linkFile\r\n      , config.sheet_name.value\r\n      , \"excel\"\r\n      , config\r\n      , this.callbackDownload);\r\n  }\r\n\r\n  /**\r\n   * Hàm xử lý gọi lại download\r\n   */\r\n  callbackDownload = function (ws: Excel.Worksheet, config: any) {\r\n    let writeExcel = this.apiExcel.processWriteExcel(this.organizationsTree, ws, config);\r\n    // console.log(writeExcel);\r\n    return { status: \"OK\", message: \"Xử lý thành công\", count: writeExcel.count };\r\n  }.bind(this)\r\n\r\n  /**\r\n   * Chọn file dữ liệu mẫu và upload để cập nhật CSDL\r\n   * @param ev \r\n   */\r\n  onClickUpload(ev) {\r\n    let arFile = ev.target.files;\r\n    // console.log(arFile);\r\n    let fr = new FileReader();\r\n    fr.readAsArrayBuffer(arFile[0]);\r\n    fr.onloadend = async () => {\r\n      let bufferData: any = fr.result;\r\n      let wb = new Excel.Workbook();\r\n      try {\r\n        let workbook = await wb.xlsx.load(bufferData);\r\n        let worksheet = workbook.getWorksheet(config.sheet_name.value);\r\n        let results = [];\r\n        worksheet.eachRow((row, rowIndex) => {\r\n          if (rowIndex > 3) {\r\n            let cols = {};\r\n            for (let key in config) {\r\n              let item = config[key];\r\n              if (key != \"sheet_name\") {\r\n                Object.defineProperty(cols\r\n                  , key\r\n                  , { value: this.getValueFormula(row.values[this.convertColExcel2Number(item.value)]) })\r\n              }\r\n            }\r\n            results.push(cols);\r\n          }\r\n        })\r\n        // console.log(results);\r\n        let returnFinish = { count_success: 0, count_fail: 0 };\r\n        for (const el of results) {\r\n          if (el.parent_id === this.userReport.organization_id) {\r\n            let jsonPost = { name: el.name, short_name: el.short_name, description: el.description, id: el.id, parent_id: el.parent_id }\r\n            // console.log(jsonPost);\r\n            try {\r\n              await this.apiAuth.postDynamicJson(this.apiAuth.serviceUrls.RESOURCE_SERVER\r\n                + '/post-organizations', jsonPost);\r\n              returnFinish.count_success++;\r\n            } catch (err) {\r\n              // console.log(err);\r\n              returnFinish.count_fail++;\r\n            }\r\n          }\r\n        }\r\n        console.log(returnFinish);\r\n        //Báo cho socket biết là thực hiện xong\r\n        this.socket.emit('Client-send-data');\r\n\r\n      } catch (err) {\r\n        console.log('Lỗi đọc file excel nguồn!', err);\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  convertColExcel2Number = (val: string): number => {\r\n    var base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', i, j, result = 0;\r\n    for (i = 0, j = val.length - 1; i < val.length; i += 1, j -= 1) {\r\n      result += Math.pow(base.length, j) * (base.indexOf(val[i]) + 1);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  getValueFormula(obj) {\r\n    if (obj === null || obj === undefined) return null;\r\n    if (typeof obj === 'object') {\r\n      // xử lý chuyển đổi chỉ lấy text thôi\r\n      if (obj.richText) return obj.richText.map(o => o[\"text\"]).join(\"\");\r\n      // lấy giá trị bằng biểu thức function\r\n      return obj.result;\r\n    }\r\n    return obj;\r\n  }\r\n\r\n}","import { Injectable } from '@angular/core';\r\nimport { AuthService } from 'ngxi4-dynamic-service';\r\n\r\nimport * as Excel from \"exceljs\";\r\nimport * as fs from 'file-saver';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ApiDownloadService {\r\n\r\n  constructor(\r\n    private apiAuth: AuthService,\r\n  ) { }\r\n\r\n  processFileDownload(\r\n    urlTemplateFile: string\r\n    , sheet_name: string\r\n    , file_name: string\r\n    , config: any\r\n    , callbackPromise: (worksheet: Excel.Worksheet, config: any) => { status: string, message: string, count: number } | { status: string, error: any }\r\n  ) {\r\n    this.apiAuth.getDynamicUrl(urlTemplateFile, '', { responseType: 'blob' })\r\n      .then(blobData => {\r\n        // console.log(blobData);\r\n        let fr = new FileReader();\r\n        fr.readAsArrayBuffer(blobData);\r\n        fr.onloadend = () => {\r\n          let bufferData: any = fr.result;\r\n          let wb = new Excel.Workbook();\r\n          wb.xlsx.load(bufferData)\r\n            .then(async workbook => {\r\n              // console.log(bufferData);\r\n              let arrayOutput = [];\r\n              workbook.eachSheet(async sheet => {\r\n                if (sheet.name === sheet_name) {\r\n                  let ws: Excel.Worksheet = sheet;\r\n                  let resultCallback = callbackPromise(ws, config);\r\n                  arrayOutput.splice(arrayOutput.length, 0, resultCallback);\r\n                } else {\r\n                  // ẩn các sheet không dùng đến\r\n                  sheet.state = 'hidden';\r\n                }\r\n              })\r\n              // console.log(arrayOutput);\r\n              if (arrayOutput.length > 0 && arrayOutput[0].status === \"OK\" && arrayOutput[0].count > 0) {\r\n\r\n                workbook.views = [\r\n                  {\r\n                    x: 0, y: 0, width: 10000, height: 20000,\r\n                    firstSheet: 0, activeTab: 0, visibility: 'visible'\r\n                  }\r\n                ];\r\n\r\n                workbook.xlsx.writeBuffer().then(data => {\r\n                  let blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\r\n                  fs.saveAs(blob, `${file_name}-${sheet_name}-${Date.now()}.xlsx`);\r\n                })\r\n              }\r\n            })\r\n            .catch(err => {\r\n              console.log('Lỗi đọc dữ liệu blob', err);\r\n            })\r\n        };\r\n      })\r\n      .catch(err => {\r\n        console.log('Lỗi lấy file mẫu từ API', err);\r\n      })\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\nimport * as Excel from \"exceljs\";\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ApiExcelService {\r\n\r\n  constructor() { }\r\n\r\n  processWriteExcel(data: any, ws: Excel.Worksheet, config: any) {\r\n    let row = ws.getRow(2);\r\n    row.getCell(\"A\").value = data[0].name;\r\n    row.getCell(\"E\").value = data[0].id;\r\n\r\n    // Xác định bề rộng cho các cột\r\n    ws.getColumn(1).width = 5;\r\n    ws.getColumn(2).alignment = { wrapText: true };\r\n    ws.getColumn(4).alignment = { wrapText: true };\r\n\r\n    let index = 0;\r\n    data[0].subs.forEach(el => {\r\n      row = ws.getRow(index + 4);\r\n      row.getCell(config.noId.value).value = index + 1;\r\n      row.getCell(config.name.value).value = el.name;\r\n      row.getCell(config.short_name.value).value = el.short_name;\r\n      row.getCell(config.description.value).value = el.description;\r\n      row.getCell(config.id.value).value = el.id;\r\n      row.getCell(config.parent_id.value).value = el.parent_id;\r\n      index++;\r\n    });\r\n\r\n    return { status: \"OK\", count: index };\r\n  }\r\n}\r\n"]}